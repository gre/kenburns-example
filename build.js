!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function Buffer(subject,encoding,noZero){if(!(this instanceof Buffer))return new Buffer(subject,encoding,noZero);var length,type=typeof subject;if("number"===type)length=subject>0?subject>>>0:0;else if("string"===type)"base64"===encoding&&(subject=base64clean(subject)),length=Buffer.byteLength(subject,encoding);else{if("object"!==type||null===subject)throw new TypeError("must start with number, buffer, array or string");"Buffer"===subject.type&&isArray(subject.data)&&(subject=subject.data),length=+subject.length>0?Math.floor(+subject.length):0}if(this.length>kMaxLength)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength.toString(16)+" bytes");var buf;Buffer.TYPED_ARRAY_SUPPORT?buf=Buffer._augment(new Uint8Array(length)):(buf=this,buf.length=length,buf._isBuffer=!0);var i;if(Buffer.TYPED_ARRAY_SUPPORT&&"number"==typeof subject.byteLength)buf._set(subject);else if(isArrayish(subject))if(Buffer.isBuffer(subject))for(i=0;length>i;i++)buf[i]=subject.readUInt8(i);else for(i=0;length>i;i++)buf[i]=(subject[i]%256+256)%256;else if("string"===type)buf.write(subject,0,encoding);else if("number"===type&&!Buffer.TYPED_ARRAY_SUPPORT&&!noZero)for(i=0;length>i;i++)buf[i]=0;return buf}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining;var strLen=string.length;if(strLen%2!==0)throw new Error("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;length>i;i++){var byte=parseInt(string.substr(2*i,2),16);if(isNaN(byte))throw new Error("Invalid hex string");buf[offset+i]=byte}return i}function utf8Write(buf,string,offset,length){var charsWritten=blitBuffer(utf8ToBytes(string),buf,offset,length);return charsWritten}function asciiWrite(buf,string,offset,length){var charsWritten=blitBuffer(asciiToBytes(string),buf,offset,length);return charsWritten}function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){var charsWritten=blitBuffer(base64ToBytes(string),buf,offset,length);return charsWritten}function utf16leWrite(buf,string,offset,length){var charsWritten=blitBuffer(utf16leToBytes(string),buf,offset,length);return charsWritten}function base64Slice(buf,start,end){return base64.fromByteArray(0===start&&end===buf.length?buf:buf.slice(start,end))}function utf8Slice(buf,start,end){var res="",tmp="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)buf[i]<=127?(res+=decodeUtf8Char(tmp)+String.fromCharCode(buf[i]),tmp=""):tmp+="%"+buf[i].toString(16);return res+decodeUtf8Char(tmp)}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)ret+=String.fromCharCode(buf[i]);return ret}function binarySlice(buf,start,end){return asciiSlice(buf,start,end)}function hexSlice(buf,start,end){var len=buf.length;(!start||0>start)&&(start=0),(!end||0>end||end>len)&&(end=len);for(var out="",i=start;end>i;i++)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!==0||0>offset)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError("buffer must be a Buffer instance");if(value>max||min>value)throw new TypeError("value is out of bounds");if(offset+ext>buf.length)throw new TypeError("index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){0>value&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);j>i;i++)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){0>value&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);j>i;i++)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(value>max||min>value)throw new TypeError("value is out of bounds");if(offset+ext>buf.length)throw new TypeError("index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){for(str=stringtrim(str).replace(INVALID_BASE64_RE,"");str.length%4!==0;)str+="=";return str}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function isArrayish(subject){return isArray(subject)||Buffer.isBuffer(subject)||subject&&"object"==typeof subject&&"number"==typeof subject.length}function toHex(n){return 16>n?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(str){for(var byteArray=[],i=0;i<str.length;i++){var b=str.charCodeAt(i);if(127>=b)byteArray.push(b);else{var start=i;b>=55296&&57343>=b&&i++;for(var h=encodeURIComponent(str.slice(start,i+1)).substr(1).split("%"),j=0;j<h.length;j++)byteArray.push(parseInt(h[j],16))}}return byteArray}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;i++)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str){for(var c,hi,lo,byteArray=[],i=0;i<str.length;i++)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(str)}function blitBuffer(src,dst,offset,length){for(var i=0;length>i&&!(i+offset>=dst.length||i>=src.length);i++)dst[i+offset]=src[i];return i}function decodeUtf8Char(str){try{return decodeURIComponent(str)}catch(err){return String.fromCharCode(65533)}}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("is-array");exports.Buffer=Buffer,exports.SlowBuffer=Buffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192;var kMaxLength=1073741823;Buffer.TYPED_ARRAY_SUPPORT=function(){try{var buf=new ArrayBuffer(0),arr=new Uint8Array(buf);return arr.foo=function(){return 42},42===arr.foo()&&"function"==typeof arr.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(e){return!1}}(),Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);len>i&&a[i]===b[i];i++);return i!==len&&(x=a[i],y=b[i]),y>x?-1:x>y?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,totalLength){if(!isArray(list))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===list.length)return new Buffer(0);if(1===list.length)return list[0];var i;if(void 0===totalLength)for(totalLength=0,i=0;i<list.length;i++)totalLength+=list[i].length;var buf=new Buffer(totalLength),pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos),pos+=item.length}return buf},Buffer.byteLength=function(str,encoding){var ret;switch(str+="",encoding||"utf8"){case"ascii":case"binary":case"raw":ret=str.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=2*str.length;break;case"hex":ret=str.length>>>1;break;case"utf8":case"utf-8":ret=utf8ToBytes(str).length;break;case"base64":ret=base64ToBytes(str).length;break;default:ret=str.length}return ret},Buffer.prototype.length=void 0,Buffer.prototype.parent=void 0,Buffer.prototype.toString=function(encoding,start,end){var loweredCase=!1;if(start>>>=0,end=void 0===end||1/0===end?this.length:end>>>0,encoding||(encoding="utf8"),0>start&&(start=0),end>this.length&&(end=this.length),start>=end)return"";for(;;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"binary":return binarySlice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return 0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return Buffer.compare(this,b)},Buffer.prototype.get=function(offset){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(offset)},Buffer.prototype.set=function(v,offset){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(v,offset)},Buffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset))isFinite(length)||(encoding=length,length=void 0);else{var swap=encoding;encoding=offset,offset=length,length=swap}offset=Number(offset)||0;var remaining=this.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining,encoding=String(encoding||"utf8").toLowerCase();var ret;switch(encoding){case"hex":ret=hexWrite(this,string,offset,length);break;case"utf8":case"utf-8":ret=utf8Write(this,string,offset,length);break;case"ascii":ret=asciiWrite(this,string,offset,length);break;case"binary":ret=binaryWrite(this,string,offset,length);break;case"base64":ret=base64Write(this,string,offset,length);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=utf16leWrite(this,string,offset,length);break;default:throw new TypeError("Unknown encoding: "+encoding)}return ret},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(start,end){var len=this.length;if(start=~~start,end=void 0===end?len:~~end,0>start?(start+=len,0>start&&(start=0)):start>len&&(start=len),0>end?(end+=len,0>end&&(end=0)):end>len&&(end=len),start>end&&(end=start),Buffer.TYPED_ARRAY_SUPPORT)return Buffer._augment(this.subarray(start,end));for(var sliceLen=end-start,newBuf=new Buffer(sliceLen,void 0,!0),i=0;sliceLen>i;i++)newBuf[i]=this[i+start];return newBuf},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),0>value&&(value=255+value+1),this[offset]=value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),0>value&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,target_start,start,end){var source=this;if(start||(start=0),end||0===end||(end=this.length),target_start||(target_start=0),end!==start&&0!==target.length&&0!==source.length){if(start>end)throw new TypeError("sourceEnd < sourceStart");if(0>target_start||target_start>=target.length)throw new TypeError("targetStart out of bounds");if(0>start||start>=source.length)throw new TypeError("sourceStart out of bounds");if(0>end||end>source.length)throw new TypeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-target_start<end-start&&(end=target.length-target_start+start);var len=end-start;if(100>len||!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;len>i;i++)target[i+target_start]=this[i+start];else target._set(this.subarray(start,start+len),target_start)}},Buffer.prototype.fill=function(value,start,end){if(value||(value=0),start||(start=0),end||(end=this.length),start>end)throw new TypeError("end < start");if(end!==start&&0!==this.length){if(0>start||start>=this.length)throw new TypeError("start out of bounds");if(0>end||end>this.length)throw new TypeError("end out of bounds");var i;if("number"==typeof value)for(i=start;end>i;i++)this[i]=value;else{var bytes=utf8ToBytes(value.toString()),len=bytes.length;for(i=start;end>i;i++)this[i]=bytes[i%len]}return this}},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer.TYPED_ARRAY_SUPPORT)return new Buffer(this).buffer;for(var buf=new Uint8Array(this.length),i=0,len=buf.length;len>i;i+=1)buf[i]=this[i];return buf.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(arr){return arr._isBuffer=!0,arr._get=arr.get,arr._set=arr.set,arr.get=BP.get,arr.set=BP.set,arr.write=BP.write,arr.toString=BP.toString,arr.toLocaleString=BP.toString,arr.toJSON=BP.toJSON,arr.equals=BP.equals,arr.compare=BP.compare,arr.copy=BP.copy,arr.slice=BP.slice,arr.readUInt8=BP.readUInt8,arr.readUInt16LE=BP.readUInt16LE,arr.readUInt16BE=BP.readUInt16BE,arr.readUInt32LE=BP.readUInt32LE,arr.readUInt32BE=BP.readUInt32BE,arr.readInt8=BP.readInt8,arr.readInt16LE=BP.readInt16LE,arr.readInt16BE=BP.readInt16BE,arr.readInt32LE=BP.readInt32LE,arr.readInt32BE=BP.readInt32BE,arr.readFloatLE=BP.readFloatLE,arr.readFloatBE=BP.readFloatBE,arr.readDoubleLE=BP.readDoubleLE,arr.readDoubleBE=BP.readDoubleBE,arr.writeUInt8=BP.writeUInt8,arr.writeUInt16LE=BP.writeUInt16LE,arr.writeUInt16BE=BP.writeUInt16BE,arr.writeUInt32LE=BP.writeUInt32LE,arr.writeUInt32BE=BP.writeUInt32BE,arr.writeInt8=BP.writeInt8,arr.writeInt16LE=BP.writeInt16LE,arr.writeInt16BE=BP.writeInt16BE,arr.writeInt32LE=BP.writeInt32LE,arr.writeInt32BE=BP.writeInt32BE,arr.writeFloatLE=BP.writeFloatLE,arr.writeFloatBE=BP.writeFloatBE,arr.writeDoubleLE=BP.writeDoubleLE,arr.writeDoubleBE=BP.writeDoubleBE,arr.fill=BP.fill,arr.inspect=BP.inspect,arr.toArrayBuffer=BP.toArrayBuffer,arr};var INVALID_BASE64_RE=/[^+\/0-9A-z]/g},{"base64-js":2,ieee754:3,"is-array":4}],2:[function(require,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(exports){"use strict";function decode(elt){var code=elt.charCodeAt(0);return code===PLUS?62:code===SLASH?63:NUMBER>code?-1:NUMBER+10>code?code-NUMBER+26+26:UPPER+26>code?code-UPPER:LOWER+26>code?code-LOWER+26:void 0}function b64ToByteArray(b64){function push(v){arr[L++]=v}var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0,arr=new Arr(3*b64.length/4-placeHolders),l=placeHolders>0?b64.length-4:b64.length;var L=0;for(i=0,j=0;l>i;i+=4,j+=3)tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3)),push((16711680&tmp)>>16),push((65280&tmp)>>8),push(255&tmp);return 2===placeHolders?(tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4,push(255&tmp)):1===placeHolders&&(tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2,push(tmp>>8&255),push(255&tmp)),arr}function uint8ToBase64(uint8){function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(63&num)}var i,temp,length,extraBytes=uint8.length%3,output="";for(i=0,length=uint8.length-extraBytes;length>i;i+=3)temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output+=tripletToBase64(temp);switch(extraBytes){case 1:temp=uint8[uint8.length-1],output+=encode(temp>>2),output+=encode(temp<<4&63),output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1],output+=encode(temp>>10),output+=encode(temp>>4&63),output+=encode(temp<<2&63),output+="="}return output}var Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,PLUS="+".charCodeAt(0),SLASH="/".charCodeAt(0),NUMBER="0".charCodeAt(0),LOWER="a".charCodeAt(0),UPPER="A".charCodeAt(0);exports.toByteArray=b64ToByteArray,exports.fromByteArray=uint8ToBase64}("undefined"==typeof exports?this.base64js={}:exports)},{}],3:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?0/0:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=0>value||0===value&&0>1/value?1:0;for(value=Math.abs(value),isNaN(value)||1/0===value?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],4:[function(require,module){var isArray=Array.isArray,str=Object.prototype.toString;module.exports=isArray||function(val){return!!val&&"[object Array]"==str.call(val)}},{}],5:[function(require,module){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||0>n||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(er=arguments[1],er instanceof Error)throw er;throw TypeError('Uncaught, unspecified "error" event.')}if(handler=this._events[type],isUndefined(handler))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:for(len=arguments.length,args=new Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];handler.apply(this,args)}else if(isObject(handler)){for(len=arguments.length,args=new Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];for(listeners=handler.slice(),len=listeners.length,i=0;len>i;i++)listeners[i].apply(this,args)}return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned){var m;m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,m&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(list=this._events[type],length=list.length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-->0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(0>position)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(listeners=this._events[type],isFunction(listeners))this.removeListener(type,listeners);else for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){var ret;return ret=this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.listenerCount=function(emitter,type){var ret;return ret=emitter._events&&emitter._events[type]?isFunction(emitter._events[type])?1:emitter._events[type].length:0}},{}],6:[function(require,module){module.exports="function"==typeof Object.create?function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],7:[function(require,module){module.exports=Array.isArray||function(arr){return"[object Array]"==Object.prototype.toString.call(arr)}},{}],8:[function(require,module){function noop(){}var process=module.exports={};process.nextTick=function(){var canSetImmediate="undefined"!=typeof window&&window.setImmediate,canMutationObserver="undefined"!=typeof window&&window.MutationObserver,canPost="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};var queue=[];if(canMutationObserver){var hiddenDiv=document.createElement("div"),observer=new MutationObserver(function(){var queueList=queue.slice();queue.length=0,queueList.forEach(function(fn){fn()})});return observer.observe(hiddenDiv,{attributes:!0}),function(fn){queue.length||hiddenDiv.setAttribute("yes","no"),queue.push(fn)}}return canPost?(window.addEventListener("message",function(ev){var source=ev.source;if((source===window||null===source)&&"process-tick"===ev.data&&(ev.stopPropagation(),queue.length>0)){var fn=queue.shift();fn()}},!0),function(fn){queue.push(fn),window.postMessage("process-tick","*")}):function(fn){setTimeout(fn,0)}}(),process.title="browser",process.browser=!0,process.env={},process.argv=[],process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw new Error("process.chdir is not supported")}},{}],9:[function(require,module){module.exports=require("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":10}],10:[function(require,module){(function(process){function Duplex(options){return this instanceof Duplex?(Readable.call(this,options),Writable.call(this,options),options&&options.readable===!1&&(this.readable=!1),options&&options.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,options&&options.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",onend)):new Duplex(options)}function onend(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach(xs,f){for(var i=0,l=xs.length;l>i;i++)f(xs[i],i)}module.exports=Duplex;var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys},util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable),forEach(objectKeys(Writable.prototype),function(method){Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])})}).call(this,require("_process"))},{"./_stream_readable":12,"./_stream_writable":14,_process:8,"core-util-is":15,inherits:6}],11:[function(require,module){function PassThrough(options){return this instanceof PassThrough?void Transform.call(this,options):new PassThrough(options)}module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":13,"core-util-is":15,inherits:6}],12:[function(require,module){(function(process){function ReadableState(options){options=options||{};var hwm=options.highWaterMark;this.highWaterMark=hwm||0===hwm?hwm:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!options.objectMode,this.defaultEncoding=options.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,options.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(options.encoding),this.encoding=options.encoding)
}function Readable(options){return this instanceof Readable?(this._readableState=new ReadableState(options,this),this.readable=!0,void Stream.call(this)):new Readable(options)}function readableAddChunk(stream,state,chunk,encoding,addToFront){var er=chunkInvalid(state,chunk);if(er)stream.emit("error",er);else if(null===chunk||void 0===chunk)state.reading=!1,state.ended||onEofChunk(stream,state);else if(state.objectMode||chunk&&chunk.length>0)if(state.ended&&!addToFront){var e=new Error("stream.push() after EOF");stream.emit("error",e)}else if(state.endEmitted&&addToFront){var e=new Error("stream.unshift() after end event");stream.emit("error",e)}else!state.decoder||addToFront||encoding||(chunk=state.decoder.write(chunk)),state.length+=state.objectMode?1:chunk.length,addToFront?state.buffer.unshift(chunk):(state.reading=!1,state.buffer.push(chunk)),state.needReadable&&emitReadable(stream),maybeReadMore(stream,state);else addToFront||(state.reading=!1);return needMoreData(state)}function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||0===state.length)}function roundUpToNextPowerOf2(n){if(n>=MAX_HWM)n=MAX_HWM;else{n--;for(var p=1;32>p;p<<=1)n|=n>>p;n++}return n}function howMuchToRead(n,state){return 0===state.length&&state.ended?0:state.objectMode?0===n?0:1:null===n||isNaN(n)?state.flowing&&state.buffer.length?state.buffer[0].length:state.length:0>=n?0:(n>state.highWaterMark&&(state.highWaterMark=roundUpToNextPowerOf2(n)),n>state.length?state.ended?state.length:(state.needReadable=!0,0):n)}function chunkInvalid(state,chunk){var er=null;return Buffer.isBuffer(chunk)||"string"==typeof chunk||null===chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er}function onEofChunk(stream,state){if(state.decoder&&!state.ended){var chunk=state.decoder.end();chunk&&chunk.length&&(state.buffer.push(chunk),state.length+=state.objectMode?1:chunk.length)}state.ended=!0,state.length>0?emitReadable(stream):endReadable(stream)}function emitReadable(stream){var state=stream._readableState;state.needReadable=!1,state.emittedReadable||(state.emittedReadable=!0,state.sync?process.nextTick(function(){emitReadable_(stream)}):emitReadable_(stream))}function emitReadable_(stream){stream.emit("readable")}function maybeReadMore(stream,state){state.readingMore||(state.readingMore=!0,process.nextTick(function(){maybeReadMore_(stream,state)}))}function maybeReadMore_(stream,state){for(var len=state.length;!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark&&(stream.read(0),len!==state.length);)len=state.length;state.readingMore=!1}function pipeOnDrain(src){return function(){var state=src._readableState;state.awaitDrain--,0===state.awaitDrain&&flow(src)}}function flow(src){function write(dest){var written=dest.write(chunk);!1===written&&state.awaitDrain++}var chunk,state=src._readableState;for(state.awaitDrain=0;state.pipesCount&&null!==(chunk=src.read());)if(1===state.pipesCount?write(state.pipes,0,null):forEach(state.pipes,write),src.emit("data",chunk),state.awaitDrain>0)return;return 0===state.pipesCount?(state.flowing=!1,void(EE.listenerCount(src,"data")>0&&emitDataEvents(src))):void(state.ranOut=!0)}function pipeOnReadable(){this._readableState.ranOut&&(this._readableState.ranOut=!1,flow(this))}function emitDataEvents(stream,startPaused){var state=stream._readableState;if(state.flowing)throw new Error("Cannot switch to old mode now.");var paused=startPaused||!1,readable=!1;stream.readable=!0,stream.pipe=Stream.prototype.pipe,stream.on=stream.addListener=Stream.prototype.on,stream.on("readable",function(){readable=!0;for(var c;!paused&&null!==(c=stream.read());)stream.emit("data",c);null===c&&(readable=!1,stream._readableState.needReadable=!0)}),stream.pause=function(){paused=!0,this.emit("pause")},stream.resume=function(){paused=!1,readable?process.nextTick(function(){stream.emit("readable")}):this.read(0),this.emit("resume")},stream.emit("readable")}function fromList(n,state){var ret,list=state.buffer,length=state.length,stringMode=!!state.decoder,objectMode=!!state.objectMode;if(0===list.length)return null;if(0===length)ret=null;else if(objectMode)ret=list.shift();else if(!n||n>=length)ret=stringMode?list.join(""):Buffer.concat(list,length),list.length=0;else if(n<list[0].length){var buf=list[0];ret=buf.slice(0,n),list[0]=buf.slice(n)}else if(n===list[0].length)ret=list.shift();else{ret=stringMode?"":new Buffer(n);for(var c=0,i=0,l=list.length;l>i&&n>c;i++){var buf=list[0],cpy=Math.min(n-c,buf.length);stringMode?ret+=buf.slice(0,cpy):buf.copy(ret,c,0,cpy),cpy<buf.length?list[0]=buf.slice(cpy):list.shift(),c+=cpy}}return ret}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error("endReadable called on non-empty stream");!state.endEmitted&&state.calledRead&&(state.ended=!0,process.nextTick(function(){state.endEmitted||0!==state.length||(state.endEmitted=!0,stream.readable=!1,stream.emit("end"))}))}function forEach(xs,f){for(var i=0,l=xs.length;l>i;i++)f(xs[i],i)}function indexOf(xs,x){for(var i=0,l=xs.length;l>i;i++)if(xs[i]===x)return i;return-1}module.exports=Readable;var isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(emitter,type){return emitter.listeners(type).length});var Stream=require("stream"),util=require("core-util-is");util.inherits=require("inherits");var StringDecoder;util.inherits(Readable,Stream),Readable.prototype.push=function(chunk,encoding){var state=this._readableState;return"string"!=typeof chunk||state.objectMode||(encoding=encoding||state.defaultEncoding,encoding!==state.encoding&&(chunk=new Buffer(chunk,encoding),encoding="")),readableAddChunk(this,state,chunk,encoding,!1)},Readable.prototype.unshift=function(chunk){var state=this._readableState;return readableAddChunk(this,state,chunk,"",!0)},Readable.prototype.setEncoding=function(enc){StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(enc),this._readableState.encoding=enc};var MAX_HWM=8388608;Readable.prototype.read=function(n){var state=this._readableState;state.calledRead=!0;var ret,nOrig=n;if(("number"!=typeof n||n>0)&&(state.emittedReadable=!1),0===n&&state.needReadable&&(state.length>=state.highWaterMark||state.ended))return emitReadable(this),null;if(n=howMuchToRead(n,state),0===n&&state.ended)return ret=null,state.length>0&&state.decoder&&(ret=fromList(n,state),state.length-=ret.length),0===state.length&&endReadable(this),ret;var doRead=state.needReadable;return state.length-n<=state.highWaterMark&&(doRead=!0),(state.ended||state.reading)&&(doRead=!1),doRead&&(state.reading=!0,state.sync=!0,0===state.length&&(state.needReadable=!0),this._read(state.highWaterMark),state.sync=!1),doRead&&!state.reading&&(n=howMuchToRead(nOrig,state)),ret=n>0?fromList(n,state):null,null===ret&&(state.needReadable=!0,n=0),state.length-=n,0!==state.length||state.ended||(state.needReadable=!0),state.ended&&!state.endEmitted&&0===state.length&&endReadable(this),ret},Readable.prototype._read=function(){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(dest,pipeOpts){function onunpipe(readable){readable===src&&cleanup()}function onend(){dest.end()}function cleanup(){dest.removeListener("close",onclose),dest.removeListener("finish",onfinish),dest.removeListener("drain",ondrain),dest.removeListener("error",onerror),dest.removeListener("unpipe",onunpipe),src.removeListener("end",onend),src.removeListener("end",cleanup),(!dest._writableState||dest._writableState.needDrain)&&ondrain()}function onerror(er){unpipe(),dest.removeListener("error",onerror),0===EE.listenerCount(dest,"error")&&dest.emit("error",er)}function onclose(){dest.removeListener("finish",onfinish),unpipe()}function onfinish(){dest.removeListener("close",onclose),unpipe()}function unpipe(){src.unpipe(dest)}var src=this,state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest)}state.pipesCount+=1;var doEnd=(!pipeOpts||pipeOpts.end!==!1)&&dest!==process.stdout&&dest!==process.stderr,endFn=doEnd?onend:cleanup;state.endEmitted?process.nextTick(endFn):src.once("end",endFn),dest.on("unpipe",onunpipe);var ondrain=pipeOnDrain(src);return dest.on("drain",ondrain),dest._events&&dest._events.error?isArray(dest._events.error)?dest._events.error.unshift(onerror):dest._events.error=[onerror,dest._events.error]:dest.on("error",onerror),dest.once("close",onclose),dest.once("finish",onfinish),dest.emit("pipe",src),state.flowing||(this.on("readable",pipeOnReadable),state.flowing=!0,process.nextTick(function(){flow(src)})),dest},Readable.prototype.unpipe=function(dest){var state=this._readableState;if(0===state.pipesCount)return this;if(1===state.pipesCount)return dest&&dest!==state.pipes?this:(dest||(dest=state.pipes),state.pipes=null,state.pipesCount=0,this.removeListener("readable",pipeOnReadable),state.flowing=!1,dest&&dest.emit("unpipe",this),this);if(!dest){var dests=state.pipes,len=state.pipesCount;state.pipes=null,state.pipesCount=0,this.removeListener("readable",pipeOnReadable),state.flowing=!1;for(var i=0;len>i;i++)dests[i].emit("unpipe",this);return this}var i=indexOf(state.pipes,dest);return-1===i?this:(state.pipes.splice(i,1),state.pipesCount-=1,1===state.pipesCount&&(state.pipes=state.pipes[0]),dest.emit("unpipe",this),this)},Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if("data"!==ev||this._readableState.flowing||emitDataEvents(this),"readable"===ev&&this.readable){var state=this._readableState;state.readableListening||(state.readableListening=!0,state.emittedReadable=!1,state.needReadable=!0,state.reading?state.length&&emitReadable(this,state):this.read(0))}return res},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){emitDataEvents(this),this.read(0),this.emit("resume")},Readable.prototype.pause=function(){emitDataEvents(this,!0),this.emit("pause")},Readable.prototype.wrap=function(stream){var state=this._readableState,paused=!1,self=this;stream.on("end",function(){if(state.decoder&&!state.ended){var chunk=state.decoder.end();chunk&&chunk.length&&self.push(chunk)}self.push(null)}),stream.on("data",function(chunk){if(state.decoder&&(chunk=state.decoder.write(chunk)),(!state.objectMode||null!==chunk&&void 0!==chunk)&&(state.objectMode||chunk&&chunk.length)){var ret=self.push(chunk);ret||(paused=!0,stream.pause())}});for(var i in stream)"function"==typeof stream[i]&&"undefined"==typeof this[i]&&(this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i));var events=["error","close","destroy","pause","resume"];return forEach(events,function(ev){stream.on(ev,self.emit.bind(self,ev))}),self._read=function(){paused&&(paused=!1,stream.resume())},self},Readable._fromList=fromList}).call(this,require("_process"))},{_process:8,buffer:1,"core-util-is":15,events:5,inherits:6,isarray:7,stream:20,"string_decoder/":21}],13:[function(require,module){function TransformState(options,stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=!1;var cb=ts.writecb;if(!cb)return stream.emit("error",new Error("no writecb in Transform class"));ts.writechunk=null,ts.writecb=null,null!==data&&void 0!==data&&stream.push(data),cb&&cb(er);var rs=stream._readableState;rs.reading=!1,(rs.needReadable||rs.length<rs.highWaterMark)&&stream._read(rs.highWaterMark)}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options);var stream=(this._transformState=new TransformState(options,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(er){done(stream,er)}):done(stream)})}function done(stream,er){if(er)return stream.emit("error",er);var ws=stream._writableState,ts=(stream._readableState,stream._transformState);if(ws.length)throw new Error("calling transform done when ws.length != 0");if(ts.transforming)throw new Error("calling transform done when still transforming");return stream.push(null)}module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(chunk,encoding){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,chunk,encoding)},Transform.prototype._transform=function(){throw new Error("not implemented")},Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;if(ts.writecb=cb,ts.writechunk=chunk,ts.writeencoding=encoding,!ts.transforming){var rs=this._readableState;(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)&&this._read(rs.highWaterMark)}},Transform.prototype._read=function(){var ts=this._transformState;null!==ts.writechunk&&ts.writecb&&!ts.transforming?(ts.transforming=!0,this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)):ts.needTransform=!0}},{"./_stream_duplex":10,"core-util-is":15,inherits:6}],14:[function(require,module){(function(process){function WriteReq(chunk,encoding,cb){this.chunk=chunk,this.encoding=encoding,this.callback=cb}function WritableState(options,stream){options=options||{};var hwm=options.highWaterMark;this.highWaterMark=hwm||0===hwm?hwm:16384,this.objectMode=!!options.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var noDecode=options.decodeStrings===!1;this.decodeStrings=!noDecode,this.defaultEncoding=options.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(er){onwrite(stream,er)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function Writable(options){var Duplex=require("./_stream_duplex");return this instanceof Writable||this instanceof Duplex?(this._writableState=new WritableState(options,this),this.writable=!0,void Stream.call(this)):new Writable(options)}function writeAfterEnd(stream,state,cb){var er=new Error("write after end");stream.emit("error",er),process.nextTick(function(){cb(er)})}function validChunk(stream,state,chunk,cb){var valid=!0;if(!Buffer.isBuffer(chunk)&&"string"!=typeof chunk&&null!==chunk&&void 0!==chunk&&!state.objectMode){var er=new TypeError("Invalid non-string/buffer chunk");stream.emit("error",er),process.nextTick(function(){cb(er)}),valid=!1}return valid}function decodeChunk(state,chunk,encoding){return state.objectMode||state.decodeStrings===!1||"string"!=typeof chunk||(chunk=new Buffer(chunk,encoding)),chunk}function writeOrBuffer(stream,state,chunk,encoding,cb){chunk=decodeChunk(state,chunk,encoding),Buffer.isBuffer(chunk)&&(encoding="buffer");var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;return ret||(state.needDrain=!0),state.writing?state.buffer.push(new WriteReq(chunk,encoding,cb)):doWrite(stream,state,len,chunk,encoding,cb),ret}function doWrite(stream,state,len,chunk,encoding,cb){state.writelen=len,state.writecb=cb,state.writing=!0,state.sync=!0,stream._write(chunk,encoding,state.onwrite),state.sync=!1}function onwriteError(stream,state,sync,er,cb){sync?process.nextTick(function(){cb(er)}):cb(er),stream._writableState.errorEmitted=!0,stream.emit("error",er)}function onwriteStateUpdate(state){state.writing=!1,state.writecb=null,state.length-=state.writelen,state.writelen=0}function onwrite(stream,er){var state=stream._writableState,sync=state.sync,cb=state.writecb;if(onwriteStateUpdate(state),er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(stream,state);finished||state.bufferProcessing||!state.buffer.length||clearBuffer(stream,state),sync?process.nextTick(function(){afterWrite(stream,state,finished,cb)}):afterWrite(stream,state,finished,cb)}}function afterWrite(stream,state,finished,cb){finished||onwriteDrain(stream,state),cb(),finished&&finishMaybe(stream,state)}function onwriteDrain(stream,state){0===state.length&&state.needDrain&&(state.needDrain=!1,stream.emit("drain"))}function clearBuffer(stream,state){state.bufferProcessing=!0;for(var c=0;c<state.buffer.length;c++){var entry=state.buffer[c],chunk=entry.chunk,encoding=entry.encoding,cb=entry.callback,len=state.objectMode?1:chunk.length;if(doWrite(stream,state,len,chunk,encoding,cb),state.writing){c++;break}}state.bufferProcessing=!1,c<state.buffer.length?state.buffer=state.buffer.slice(c):state.buffer.length=0}function needFinish(stream,state){return state.ending&&0===state.length&&!state.finished&&!state.writing}function finishMaybe(stream,state){var need=needFinish(stream,state);return need&&(state.finished=!0,stream.emit("finish")),need}function endWritable(stream,state,cb){state.ending=!0,finishMaybe(stream,state),cb&&(state.finished?process.nextTick(cb):stream.once("finish",cb)),state.ended=!0}module.exports=Writable;var Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream=require("stream");util.inherits(Writable,Stream),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState,ret=!1;return"function"==typeof encoding&&(cb=encoding,encoding=null),Buffer.isBuffer(chunk)?encoding="buffer":encoding||(encoding=state.defaultEncoding),"function"!=typeof cb&&(cb=function(){}),state.ended?writeAfterEnd(this,state,cb):validChunk(this,state,chunk,cb)&&(ret=writeOrBuffer(this,state,chunk,encoding,cb)),ret},Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("not implemented"))},Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;"function"==typeof chunk?(cb=chunk,chunk=null,encoding=null):"function"==typeof encoding&&(cb=encoding,encoding=null),"undefined"!=typeof chunk&&null!==chunk&&this.write(chunk,encoding),state.ending||state.finished||endWritable(this,state,cb)}}).call(this,require("_process"))},{"./_stream_duplex":10,_process:8,buffer:1,"core-util-is":15,inherits:6,stream:20}],15:[function(require,module,exports){(function(Buffer){function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||"undefined"==typeof arg}function isBuffer(arg){return Buffer.isBuffer(arg)}function objectToString(o){return Object.prototype.toString.call(o)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=isBuffer}).call(this,require("buffer").Buffer)},{buffer:1}],16:[function(require,module){module.exports=require("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":11}],17:[function(require,module,exports){exports=module.exports=require("./lib/_stream_readable.js"),exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":10,"./lib/_stream_passthrough.js":11,"./lib/_stream_readable.js":12,"./lib/_stream_transform.js":13,"./lib/_stream_writable.js":14}],18:[function(require,module){module.exports=require("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":13}],19:[function(require,module){module.exports=require("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":14}],20:[function(require,module){function Stream(){EE.call(this)}module.exports=Stream;var EE=require("events").EventEmitter,inherits=require("inherits");inherits(Stream,EE),Stream.Readable=require("readable-stream/readable.js"),Stream.Writable=require("readable-stream/writable.js"),Stream.Duplex=require("readable-stream/duplex.js"),Stream.Transform=require("readable-stream/transform.js"),Stream.PassThrough=require("readable-stream/passthrough.js"),Stream.Stream=Stream,Stream.prototype.pipe=function(dest,options){function ondata(chunk){dest.writable&&!1===dest.write(chunk)&&source.pause&&source.pause()}function ondrain(){source.readable&&source.resume&&source.resume()}function onend(){didOnEnd||(didOnEnd=!0,dest.end())}function onclose(){didOnEnd||(didOnEnd=!0,"function"==typeof dest.destroy&&dest.destroy())}function onerror(er){if(cleanup(),0===EE.listenerCount(this,"error"))throw er}function cleanup(){source.removeListener("data",ondata),dest.removeListener("drain",ondrain),source.removeListener("end",onend),source.removeListener("close",onclose),source.removeListener("error",onerror),dest.removeListener("error",onerror),source.removeListener("end",cleanup),source.removeListener("close",cleanup),dest.removeListener("close",cleanup)}var source=this;source.on("data",ondata),dest.on("drain",ondrain),dest._isStdio||options&&options.end===!1||(source.on("end",onend),source.on("close",onclose));var didOnEnd=!1;return source.on("error",onerror),dest.on("error",onerror),source.on("end",cleanup),source.on("close",cleanup),dest.on("close",cleanup),dest.emit("pipe",source),dest}},{events:5,inherits:6,"readable-stream/duplex.js":9,"readable-stream/passthrough.js":16,"readable-stream/readable.js":17,"readable-stream/transform.js":18,"readable-stream/writable.js":19}],21:[function(require,module,exports){function assertEncoding(encoding){if(encoding&&!isBufferEncoding(encoding))throw new Error("Unknown encoding: "+encoding)}function passThroughWrite(buffer){return buffer.toString(this.encoding)}function utf16DetectIncompleteChar(buffer){this.charReceived=buffer.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(buffer){this.charReceived=buffer.length%3,this.charLength=this.charReceived?3:0}var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(encoding){switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},StringDecoder=exports.StringDecoder=function(encoding){switch(this.encoding=(encoding||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(encoding),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};StringDecoder.prototype.write=function(buffer){for(var charStr="";this.charLength;){var available=buffer.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:buffer.length;if(buffer.copy(this.charBuffer,this.charReceived,0,available),this.charReceived+=available,this.charReceived<this.charLength)return"";buffer=buffer.slice(available,buffer.length),charStr=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var charCode=charStr.charCodeAt(charStr.length-1);if(!(charCode>=55296&&56319>=charCode)){if(this.charReceived=this.charLength=0,0===buffer.length)return charStr;break}this.charLength+=this.surrogateSize,charStr=""}this.detectIncompleteChar(buffer);var end=buffer.length;this.charLength&&(buffer.copy(this.charBuffer,0,buffer.length-this.charReceived,end),end-=this.charReceived),charStr+=buffer.toString(this.encoding,0,end);var end=charStr.length-1,charCode=charStr.charCodeAt(end);if(charCode>=55296&&56319>=charCode){var size=this.surrogateSize;return this.charLength+=size,this.charReceived+=size,this.charBuffer.copy(this.charBuffer,size,0,size),buffer.copy(this.charBuffer,0,0,size),charStr.substring(0,end)}return charStr},StringDecoder.prototype.detectIncompleteChar=function(buffer){for(var i=buffer.length>=3?3:buffer.length;i>0;i--){var c=buffer[buffer.length-i];if(1==i&&c>>5==6){this.charLength=2;break}if(2>=i&&c>>4==14){this.charLength=3;break}if(3>=i&&c>>3==30){this.charLength=4;break}}this.charReceived=i},StringDecoder.prototype.end=function(buffer){var res="";if(buffer&&buffer.length&&(res=this.write(buffer)),this.charReceived){var cr=this.charReceived,buf=this.charBuffer,enc=this.encoding;res+=buf.slice(0,cr).toString(enc)}return res}},{buffer:1}],22:[function(require){function createCanvas(){var canvas=document.createElement("canvas");return canvas.width=640,canvas.height=480,canvas}function createDiv(){var div=document.createElement("div");return div.style.width="640px",div.style.height="480px",div}var KenBurns=require("kenburns"),Q=require("q"),Qimage=require("qimage"),BezierEasing=require("bezier-easing"),TransitionFade=require("transition-fade");[{name:"Canvas2D",kenburns:KenBurns.Canvas2D,fade:TransitionFade.Canvas2D,createElement:createCanvas},{name:"WebGL",kenburns:KenBurns.WebGL,fade:TransitionFade.WebGL,createElement:createCanvas},{name:"DOM (experimental)",kenburns:KenBurns.DOM,fade:TransitionFade.DOM,createElement:createDiv}].map(function(params){function display(elt){var child=container.children[0];child&&container.removeChild(child),container.appendChild(elt)}function displayF(elt){return function(o){return display(elt),o}}var h1=document.createElement("h1");h1.textContent=params.name,document.body.appendChild(h1);var container=document.createElement("div");document.body.appendChild(container);var transitionElt=params.createElement(),elt1=params.createElement(),elt2=params.createElement(),fade=params.fade(transitionElt),kenBurns1=new params.kenburns(elt1),kenBurns2=new params.kenburns(elt2);Q.all(["https://upload.wikimedia.org/wikipedia/commons/thumb/8/89/Robert_Edward_Lee.jpg/692px-Robert_Edward_Lee.jpg","http://upload.wikimedia.org/wikipedia/commons/2/2e/George_Gordon_Meade.jpg","http://upload.wikimedia.org/wikipedia/commons/6/69/Battle_of_Gettysburg%2C_by_Currier_and_Ives.png","http://upload.wikimedia.org/wikipedia/commons/3/33/Battle_of_Gettysburg.jpg"].map(Qimage.anonymously)).then(function(images){var robertSteps=[KenBurns.crop(1,[.5,.15]),KenBurns.crop(.75,[.5,.15])],georgeSteps=[KenBurns.crop(1.6,[.5,.35]),KenBurns.crop(.68,[.5,.28])],battleSteps=[KenBurns.crop(.48,[.16,.48]),KenBurns.crop(.48,[.82,.35]),KenBurns.crop(.34,[.49,.45]),KenBurns.crop(.34,[0,.72]),KenBurns.crop(.38,[.62,.78]),KenBurns.crop.largest],battleRealSteps=[KenBurns.crop.largest,KenBurns.crop(.3,[.7,.7])];return Q(images[0]).then(displayF(elt1)).then(kenBurns1.runPartial(robertSteps[0],robertSteps[1],5e3)).delay(4e3).then(function(){return display(transitionElt),kenBurns1.one(images[0],robertSteps[1]),Q.all([kenBurns2.setClamped(!1).run(images[1],georgeSteps[0],georgeSteps[1],6e3,BezierEasing(0,0,.5,1)),fade(elt1,elt2,2e3).then(displayF(elt2))])}).delay(4e3).thenResolve(images[2]).then(kenBurns1.onePartial(battleSteps[0])).then(displayF(elt1)).delay(3500).then(kenBurns1.runPartial(battleSteps[0],battleSteps[1],400)).delay(3500).then(kenBurns1.runPartial(battleSteps[1],battleSteps[2],400)).delay(3500).then(kenBurns1.runPartial(battleSteps[2],battleSteps[3],400)).delay(3500).then(kenBurns1.runPartial(battleSteps[3],battleSteps[4],400)).delay(3500).then(kenBurns1.runPartial(battleSteps[4],battleSteps[5],200)).delay(5e3).then(function(){return display(transitionElt),kenBurns1.one(images[2],battleSteps[5]),fade(elt1,images[3],2e3)}).thenResolve(images[3]).then(kenBurns2.onePartial(battleRealSteps[0])).then(displayF(elt2)).delay(2e3).then(kenBurns2.runPartial(battleRealSteps[0],battleRealSteps[1],2e3))}).done()})},{"bezier-easing":23,kenburns:24,q:47,qimage:48,"transition-fade":52}],23:[function(require,module,exports){!function(definition){"object"==typeof exports?module.exports=definition():"function"==typeof define&&define.amd?define([],definition):window.BezierEasing=definition()}(function(){function BezierEasing(mX1,mY1,mX2,mY2){function A(aA1,aA2){return 1-3*aA2+3*aA1}function B(aA1,aA2){return 3*aA2-6*aA1}function C(aA1){return 3*aA1}function calcBezier(aT,aA1,aA2){return((A(aA1,aA2)*aT+B(aA1,aA2))*aT+C(aA1))*aT}function getSlope(aT,aA1,aA2){return 3*A(aA1,aA2)*aT*aT+2*B(aA1,aA2)*aT+C(aA1)}function newtonRaphsonIterate(aX,aGuessT){for(var i=0;NEWTON_ITERATIONS>i;++i){var currentSlope=getSlope(aGuessT,mX1,mX2);if(0===currentSlope)return aGuessT;var currentX=calcBezier(aGuessT,mX1,mX2)-aX;aGuessT-=currentX/currentSlope}return aGuessT}function calcSampleValues(){for(var i=0;kSplineTableSize>i;++i)mSampleValues[i]=calcBezier(i*kSampleStepSize,mX1,mX2)}function binarySubdivide(aX,aA,aB){var currentX,currentT,i=0;do currentT=aA+(aB-aA)/2,currentX=calcBezier(currentT,mX1,mX2)-aX,currentX>0?aB=currentT:aA=currentT;while(Math.abs(currentX)>SUBDIVISION_PRECISION&&++i<SUBDIVISION_MAX_ITERATIONS);return currentT}function getTForX(aX){for(var intervalStart=0,currentSample=1,lastSample=kSplineTableSize-1;currentSample!=lastSample&&mSampleValues[currentSample]<=aX;++currentSample)intervalStart+=kSampleStepSize;--currentSample;var dist=(aX-mSampleValues[currentSample])/(mSampleValues[currentSample+1]-mSampleValues[currentSample]),guessForT=intervalStart+dist*kSampleStepSize,initialSlope=getSlope(guessForT,mX1,mX2);return initialSlope>=NEWTON_MIN_SLOPE?newtonRaphsonIterate(aX,guessForT):0===initialSlope?guessForT:binarySubdivide(aX,intervalStart,intervalStart+kSampleStepSize)}function precompute(){_precomputed=!0,(mX1!=mY1||mX2!=mY2)&&calcSampleValues()}if(4!==arguments.length)throw new Error("BezierEasing requires 4 arguments.");for(var i=0;4>i;++i)if("number"!=typeof arguments[i]||isNaN(arguments[i])||!isFinite(arguments[i]))throw new Error("BezierEasing arguments should be integers.");if(0>mX1||mX1>1||0>mX2||mX2>1)throw new Error("BezierEasing x values must be in [0, 1] range.");var mSampleValues=float32ArraySupported?new Float32Array(kSplineTableSize):new Array(kSplineTableSize),_precomputed=!1,f=function(aX){return _precomputed||precompute(),mX1===mY1&&mX2===mY2?aX:0===aX?0:1===aX?1:calcBezier(getTForX(aX),mY1,mY2)};f.getControlPoints=function(){return[{x:mX1,y:mY1},{x:mX2,y:mY2}]};var args=[mX1,mY1,mX2,mY2],str="BezierEasing("+args+")";f.toString=function(){return str};var css="cubic-bezier("+args+")";return f.toCSS=function(){return css},f}var global=this,NEWTON_ITERATIONS=4,NEWTON_MIN_SLOPE=.001,SUBDIVISION_PRECISION=1e-7,SUBDIVISION_MAX_ITERATIONS=10,kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1),float32ArraySupported="Float32Array"in global;return BezierEasing.css={ease:BezierEasing(.25,.1,.25,1),linear:BezierEasing(0,0,1,1),"ease-in":BezierEasing(.42,0,1,1),"ease-out":BezierEasing(0,0,.58,1),"ease-in-out":BezierEasing(.42,0,.58,1)},BezierEasing
})},{}],24:[function(require,module){{var KenBurnsCore=require("kenburns-core"),KenBurnsCanvas2D=require("kenburns-canvas2d"),KenBurnsWebGL=require("kenburns-webgl"),KenBurnsDOM=require("kenburns-dom"),rectCrop=require("rect-crop"),rectClamp=require("rect-clamp");module.exports={crop:rectCrop,clamp:rectClamp,mixin:KenBurnsCore.mixin,Canvas2D:KenBurnsCanvas2D,WebGL:KenBurnsWebGL,DOM:KenBurnsDOM,Canvas:function(canvas){return window.WebGLRenderingContext?new KenBurnsWebGL(canvas):new KenBurnsCanvas2D(canvas)}}}},{"kenburns-canvas2d":25,"kenburns-core":27,"kenburns-dom":32,"kenburns-webgl":44,"rect-clamp":45,"rect-crop":46}],25:[function(require,module){function KenBurnsCanvas2dTrait(canvas2d){this.canvas=canvas2d,this.ctx=canvas2d.getContext("2d")}var KenBurnsCore=require("kenburns-core"),drawImageNormalized=require("draw-image-normalized");KenBurnsCanvas2dTrait.prototype={draw:function(image,rect){var viewport=[0,0,this.canvas.width,this.canvas.height],ctx=this.ctx;ctx.fillStyle="rgb("+this.rgb.map(function(x){return 255*x})+")",ctx.fillRect.apply(ctx,viewport),drawImageNormalized.apply(null,[ctx,image].concat(rect).concat(viewport))},getViewport:function(){return this.canvas}},module.exports=KenBurnsCore.mixin(KenBurnsCanvas2dTrait)},{"draw-image-normalized":26,"kenburns-core":27}],26:[function(require,module){module.exports=function(ctx,image,sx,sy,sw,sh,dx,dy,dw,dh){if(arguments.length<=6&&(dx=sx,dy=sy,dw=sw,dh=sh,sx=0,sy=0,sw=image.width,sh=image.height),arguments.length<=4&&(dw=sw,dh=sh),0>sx&&(dx-=sx*dw/sw,dw+=sx*dw/sw,sw+=sx,sx=0),0>sy&&(dy-=sy*dh/sh,dh+=sy*dh/sh,sh+=sy,sy=0),sx+sw>image.width){var x=sx+sw-image.width;dw*=(sw-x)/sw,sw=image.width}if(sy+sh>image.height){var y=sy+sh-image.height;dh*=(sh-y)/sh,sh=image.height}0>=sw||0>=sh||0>=dw||0>=dh||ctx.drawImage.apply(ctx,[image,sx,sy,sw,sh,dx,dy,dw,dh])}},{}],27:[function(require,module){function KenBurns(){this.animationDefer=null,this.setClamped(!0),this.setRGB([0,0,0])}function identity(x){return x}function noop(){}function invalidArgument(value,reason){throw console.error(value,"<- "+reason),new Error(reason)}function KenBurnsAbortedError(message){this.message=message,this.stack=(new Error).stack}function extend(obj){for(var source,prop,i=1,length=arguments.length;length>i;i++){source=arguments[i];for(prop in source)source.hasOwnProperty(prop)&&(obj[prop]=source[prop])}return obj}var Q=require("q"),requestAnimationFrame=require("raf"),now=require("performance-now"),rectClamp=require("rect-clamp"),rectMix=require("rect-mix");KenBurns.prototype={runStart:noop,runEnd:noop,destroy:noop,_getBound:function(cropBound,image){var bnds="function"==typeof cropBound?cropBound(this.getViewport(),image):cropBound;return this.clamped&&(bnds=rectClamp(bnds,[0,0,image.width,image.height])),bnds},setClamped:function(c){return this.clamped=c,this},setRGB:function(rgb){return this.rgb=rgb,this},one:function(image,crop){var boundCrop=this._getBound(crop,image);return this.runStart(image,boundCrop,boundCrop,0),this.draw(image,boundCrop),this.runEnd(),image},_runValidation:function(image,startCrop,endCrop,duration,easing){image||invalidArgument(image,"image is required."),(!duration||isNaN(duration))&&invalidArgument(duration,"duration is required and must be a number."),easing||(easing=identity),"function"!=typeof easing&&invalidArgument(easing,"easing must be a function.");var fromCropBound=this._getBound(startCrop,image),toCropBound=this._getBound(endCrop,image),startEndCropReason="startCrop and endCrop are required and must be a bound array or a function returning a bound array.";return fromCropBound instanceof Array&&4===fromCropBound.length||invalidArgument(startCrop,startEndCropReason),toCropBound instanceof Array&&4===toCropBound.length||invalidArgument(endCrop,startEndCropReason),[image,fromCropBound,toCropBound,duration,easing]},run:function(){var self=this,args=self._runValidation.apply(self,arguments),image=args[0],fromCropBound=args[1],toCropBound=args[2],duration=args[3],easing=args[4],d=Q.defer(),start=now();return self.runStart.apply(self,args),d.promise.then(self.runEnd.bind(self)).done(),self.animationDefer=d,function render(){if(self.animationDefer===d)try{var p=Math.min((now()-start)/duration,1),bound=rectMix(fromCropBound,toCropBound,easing(p));self.clamped&&(bound=rectClamp(bound,[0,0,image.width,image.height])),1>p?requestAnimationFrame(render):(d.resolve(image),self.animationDefer=null),self.draw(image,bound)}catch(e){d.reject(e),self.animationDefer=null}}(),d.promise},onePartial:function(crop){var self=this;return function(image){return self.one(image,crop)}},runPartial:function(startCrop,endCrop,duration,easing){var self=this;return function(image){return self.run.call(self,image,startCrop,endCrop,duration,easing)}},abort:function(){this.animationDefer&&(this.animationDefer.reject(new KenBurnsAbortedError("KenBurns aborted by user.")),this.animationDefer=null)}},KenBurnsAbortedError.prototype=new Error,KenBurnsAbortedError.prototype.name="KenBurnsAbortedError",KenBurns.mixin=function(Clazz){function Mixin(){KenBurns.call(this),Clazz.apply(this,arguments)}return Mixin.prototype=extend({},KenBurns.prototype,Clazz.prototype),Mixin},module.exports=KenBurns},{"performance-now":28,q:47,raf:29,"rect-clamp":45,"rect-mix":31}],28:[function(require,module){(function(process){(function(){var getNanoSeconds,hrtime,loadTime;"undefined"!=typeof performance&&null!==performance&&performance.now?module.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(module.exports=function(){return(getNanoSeconds()-loadTime)/1e6},hrtime=process.hrtime,getNanoSeconds=function(){var hr;return hr=hrtime(),1e9*hr[0]+hr[1]},loadTime=getNanoSeconds()):Date.now?(module.exports=function(){return Date.now()-loadTime},loadTime=Date.now()):(module.exports=function(){return(new Date).getTime()-loadTime},loadTime=(new Date).getTime())}).call(this)}).call(this,require("_process"))},{_process:8}],29:[function(require,module){for(var now=require("performance-now"),global="undefined"==typeof window?{}:window,vendors=["moz","webkit"],suffix="AnimationFrame",raf=global["request"+suffix],caf=global["cancel"+suffix]||global["cancelRequest"+suffix],isNative=!0,i=0;i<vendors.length&&!raf;i++)raf=global[vendors[i]+"Request"+suffix],caf=global[vendors[i]+"Cancel"+suffix]||global[vendors[i]+"CancelRequest"+suffix];if(!raf||!caf){isNative=!1;var last=0,id=0,queue=[],frameDuration=1e3/60;raf=function(callback){if(0===queue.length){var _now=now(),next=Math.max(0,frameDuration-(_now-last));last=next+_now,setTimeout(function(){var cp=queue.slice(0);queue.length=0;for(var i=0;i<cp.length;i++)if(!cp[i].cancelled)try{cp[i].callback(last)}catch(e){setTimeout(function(){throw e},0)}},Math.round(next))}return queue.push({handle:++id,callback:callback,cancelled:!1}),id},caf=function(handle){for(var i=0;i<queue.length;i++)queue[i].handle===handle&&(queue[i].cancelled=!0)}}module.exports=function(fn){return isNative?raf.call(global,function(){try{fn.apply(this,arguments)}catch(e){setTimeout(function(){throw e},0)}}):raf.call(global,fn)},module.exports.cancel=function(){caf.apply(global,arguments)}},{"performance-now":30}],30:[function(require,module){(function(process){(function(){var getNanoSeconds,hrtime,loadTime;"undefined"!=typeof performance&&null!==performance&&performance.now?module.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(module.exports=function(){return(getNanoSeconds()-loadTime)/1e6},hrtime=process.hrtime,getNanoSeconds=function(){var hr;return hr=hrtime(),1e9*hr[0]+hr[1]},loadTime=getNanoSeconds()):Date.now?(module.exports=function(){return Date.now()-loadTime},loadTime=Date.now()):(module.exports=function(){return(new Date).getTime()-loadTime},loadTime=(new Date).getTime())}).call(this)}).call(this,require("_process"))},{_process:8}],31:[function(require,module){function mix(a,b,p){return a*(1-p)+b*p}module.exports=function(a,b,p){for(var bound=[],i=0;4>i;++i)bound[i]=mix(a[i],b[i],p);return bound}},{}],32:[function(require,module){function KenBurnsDOMTrait(container){this.elt=container,"absolute"!==container.style.position&&(container.style.position="relative"),container.style.overflow="hidden"}var KenBurnsCore=require("kenburns-core"),Zanimo=require("zanimo");KenBurnsDOMTrait.prototype={getViewport:function(){return this.elt.getBoundingClientRect()},abort:function(){this.reset()},_transformForRect:function(rect){var viewport=this.getViewport(),scale=[viewport.width/rect[2],viewport.height/rect[3]],translate=[Math.round(-rect[0])+"px",Math.round(-rect[1])+"px"];return"scale("+scale+") translate("+translate+")"},_reset:function(){this.elt.style.backgroundColor="rgb("+this.rgb.map(function(c){return 255*c})+")",this.elt.innerHTML=""},_setImage:function(image){return image!==this.image&&(this._reset(),this.elt.appendChild(image),image.style.position="absolute",image.style.top="0",image.style.left="0",Zanimo(image,"transform-origin","0% 0%"),this.image=image),Zanimo(image)},_positionImage:function(rect){return Zanimo(this.image,"transform",this._transformForRect(rect))},runStart:function(image){this._setImage(image)},draw:function(image,rect){this._positionImage(rect)}},module.exports=KenBurnsCore.mixin(KenBurnsDOMTrait)},{"kenburns-core":27,zanimo:40}],33:[function(require,module){var convert=require("color-convert"),string=require("color-string");module.exports=function(cssString){return new Color(cssString)};var Color=function(cssString){if(this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],cmyk:[0,0,0,0],alpha:1},"string"==typeof cssString){var vals=string.getRgba(cssString);vals?this.setValues("rgb",vals):(vals=string.getHsla(cssString))&&this.setValues("hsl",vals)}else if("object"==typeof cssString){var vals=cssString;void 0!==vals.r||void 0!==vals.red?this.setValues("rgb",vals):void 0!==vals.l||void 0!==vals.lightness?this.setValues("hsl",vals):void 0!==vals.v||void 0!==vals.value?this.setValues("hsv",vals):(void 0!==vals.c||void 0!==vals.cyan)&&this.setValues("cmyk",vals)}};Color.prototype={rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var rgb=this.values.rgb;return rgb.concat([this.values.alpha])},hslaArray:function(){var hsl=this.values.hsl;return hsl.concat([this.values.alpha])},alpha:function(val){return void 0===val?this.values.alpha:(this.setValues("alpha",val),this)},red:function(val){return this.setChannel("rgb",0,val)},green:function(val){return this.setChannel("rgb",1,val)},blue:function(val){return this.setChannel("rgb",2,val)},hue:function(val){return this.setChannel("hsl",0,val)},saturation:function(val){return this.setChannel("hsl",1,val)},lightness:function(val){return this.setChannel("hsl",2,val)},saturationv:function(val){return this.setChannel("hsv",1,val)},value:function(val){return this.setChannel("hsv",2,val)},cyan:function(val){return this.setChannel("cmyk",0,val)},magenta:function(val){return this.setChannel("cmyk",1,val)},yellow:function(val){return this.setChannel("cmyk",2,val)},black:function(val){return this.setChannel("cmyk",3,val)},hexString:function(){return string.hexString(this.values.rgb)},rgbString:function(){return string.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return string.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return string.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return string.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return string.hslaString(this.values.hsl,this.values.alpha)},keyword:function(){return string.keyword(this.values.rgb,this.values.alpha)},luminosity:function(){for(var rgb=this.values.rgb,lum=[],i=0;i<rgb.length;i++){var chan=rgb[i]/255;lum[i]=.03928>=chan?chan/12.92:Math.pow((chan+.055)/1.055,2.4)}return.2126*lum[0]+.7152*lum[1]+.0722*lum[2]},contrast:function(color2){var lum1=this.luminosity(),lum2=color2.luminosity();return lum1>lum2?(lum1+.05)/(lum2+.05):(lum2+.05)/(lum1+.05)},level:function(color2){var contrastRatio=this.contrast(color2);return contrastRatio>=7.1?"AAA":contrastRatio>=4.5?"AA":""},dark:function(){var rgb=this.values.rgb,yiq=(299*rgb[0]+587*rgb[1]+114*rgb[2])/1e3;return 128>yiq},light:function(){return!this.dark()},negate:function(){for(var rgb=[],i=0;3>i;i++)rgb[i]=255-this.values.rgb[i];return this.setValues("rgb",rgb),this},lighten:function(ratio){return this.values.hsl[2]+=this.values.hsl[2]*ratio,this.setValues("hsl",this.values.hsl),this},darken:function(ratio){return this.values.hsl[2]-=this.values.hsl[2]*ratio,this.setValues("hsl",this.values.hsl),this},saturate:function(ratio){return this.values.hsl[1]+=this.values.hsl[1]*ratio,this.setValues("hsl",this.values.hsl),this},desaturate:function(ratio){return this.values.hsl[1]-=this.values.hsl[1]*ratio,this.setValues("hsl",this.values.hsl),this},greyscale:function(){var rgb=this.values.rgb,val=.3*rgb[0]+.59*rgb[1]+.11*rgb[2];return this.setValues("rgb",[val,val,val]),this},clearer:function(ratio){return this.setValues("alpha",this.values.alpha-this.values.alpha*ratio),this},opaquer:function(ratio){return this.setValues("alpha",this.values.alpha+this.values.alpha*ratio),this},rotate:function(degrees){var hue=this.values.hsl[0];return hue=(hue+degrees)%360,hue=0>hue?360+hue:hue,this.values.hsl[0]=hue,this.setValues("hsl",this.values.hsl),this},mix:function(color2,weight){weight=1-(null==weight?.5:weight);for(var t1=2*weight-1,d=this.alpha()-color2.alpha(),weight1=((t1*d==-1?t1:(t1+d)/(1+t1*d))+1)/2,weight2=1-weight1,rgb=this.rgbArray(),rgb2=color2.rgbArray(),i=0;i<rgb.length;i++)rgb[i]=rgb[i]*weight1+rgb2[i]*weight2;this.setValues("rgb",rgb);var alpha=this.alpha()*weight+color2.alpha()*(1-weight);return this.setValues("alpha",alpha),this},toJSON:function(){return this.rgb()},clone:function(){return new Color(this.rgb())}},Color.prototype.getValues=function(space){for(var vals={},i=0;i<space.length;i++)vals[space[i]]=this.values[space][i];return 1!=this.values.alpha&&(vals.a=this.values.alpha),vals},Color.prototype.setValues=function(space,vals){var spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],cmyk:["cyan","magenta","yellow","black"]},maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],cmyk:[100,100,100,100]},alpha=1;if("alpha"==space)alpha=vals;else if(vals.length)this.values[space]=vals.slice(0,space.length),alpha=vals[space.length];else if(void 0!==vals[space[0]]){for(var i=0;i<space.length;i++)this.values[space][i]=vals[space[i]];alpha=vals.a}else if(void 0!==vals[spaces[space][0]]){for(var chans=spaces[space],i=0;i<space.length;i++)this.values[space][i]=vals[chans[i]];alpha=vals.alpha}if(this.values.alpha=Math.max(0,Math.min(1,void 0!==alpha?alpha:this.values.alpha)),"alpha"!=space){for(var sname in spaces){sname!=space&&(this.values[sname]=convert[space][sname](this.values[space]));for(var i=0;i<sname.length;i++){var capped=Math.max(0,Math.min(maxes[sname][i],this.values[sname][i]));this.values[sname][i]=Math.round(capped)}}return!0}},Color.prototype.setSpace=function(space,args){var vals=args[0];return void 0===vals?this.getValues(space):("number"==typeof vals&&(vals=Array.prototype.slice.call(args)),this.setValues(space,vals),this)},Color.prototype.setChannel=function(space,index,val){return void 0===val?this.values[space][index]:(this.values[space][index]=val,this.setValues(space,this.values[space]),this)}},{"color-convert":35,"color-string":36}],34:[function(require,module){function rgb2hsl(rgb){var h,s,l,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min;return max==min?h=0:r==max?h=(g-b)/delta:g==max?h=2+(b-r)/delta:b==max&&(h=4+(r-g)/delta),h=Math.min(60*h,360),0>h&&(h+=360),l=(min+max)/2,s=max==min?0:.5>=l?delta/(max+min):delta/(2-max-min),[h,100*s,100*l]}function rgb2hsv(rgb){var h,s,v,r=rgb[0],g=rgb[1],b=rgb[2],min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min;return s=0==max?0:delta/max*1e3/10,max==min?h=0:r==max?h=(g-b)/delta:g==max?h=2+(b-r)/delta:b==max&&(h=4+(r-g)/delta),h=Math.min(60*h,360),0>h&&(h+=360),v=max/255*1e3/10,[h,s,v]}function rgb2cmyk(rgb){var c,m,y,k,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;return k=Math.min(1-r,1-g,1-b),c=(1-r-k)/(1-k),m=(1-g-k)/(1-k),y=(1-b-k)/(1-k),[100*c,100*m,100*y,100*k]}function rgb2keyword(rgb){return reverseKeywords[JSON.stringify(rgb)]}function rgb2xyz(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,g=g>.04045?Math.pow((g+.055)/1.055,2.4):g/12.92,b=b>.04045?Math.pow((b+.055)/1.055,2.4):b/12.92;var x=.4124*r+.3576*g+.1805*b,y=.2126*r+.7152*g+.0722*b,z=.0193*r+.1192*g+.9505*b;return[100*x,100*y,100*z]}function rgb2lab(rgb){var l,a,b,xyz=rgb2xyz(rgb),x=xyz[0],y=xyz[1],z=xyz[2];return x/=95.047,y/=100,z/=108.883,x=x>.008856?Math.pow(x,1/3):7.787*x+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,z=z>.008856?Math.pow(z,1/3):7.787*z+16/116,l=116*y-16,a=500*(x-y),b=200*(y-z),[l,a,b]}function hsl2rgb(hsl){var t1,t2,t3,rgb,val,h=hsl[0]/360,s=hsl[1]/100,l=hsl[2]/100;if(0==s)return val=255*l,[val,val,val];t2=.5>l?l*(1+s):l+s-l*s,t1=2*l-t2,rgb=[0,0,0];for(var i=0;3>i;i++)t3=h+1/3*-(i-1),0>t3&&t3++,t3>1&&t3--,val=1>6*t3?t1+6*(t2-t1)*t3:1>2*t3?t2:2>3*t3?t1+(t2-t1)*(2/3-t3)*6:t1,rgb[i]=255*val;return rgb}function hsl2hsv(hsl){var sv,v,h=hsl[0],s=hsl[1]/100,l=hsl[2]/100;return l*=2,s*=1>=l?l:2-l,v=(l+s)/2,sv=2*s/(l+s),[h,100*s,100*v]}function hsl2cmyk(args){return rgb2cmyk(hsl2rgb(args))}function hsl2keyword(args){return rgb2keyword(hsl2rgb(args))}function hsv2rgb(hsv){var h=hsv[0]/60,s=hsv[1]/100,v=hsv[2]/100,hi=Math.floor(h)%6,f=h-Math.floor(h),p=255*v*(1-s),q=255*v*(1-s*f),t=255*v*(1-s*(1-f)),v=255*v;switch(hi){case 0:return[v,t,p];case 1:return[q,v,p];case 2:return[p,v,t];case 3:return[p,q,v];case 4:return[t,p,v];case 5:return[v,p,q]}}function hsv2hsl(hsv){var sl,l,h=hsv[0],s=hsv[1]/100,v=hsv[2]/100;return l=(2-s)*v,sl=s*v,sl/=1>=l?l:2-l,l/=2,[h,100*sl,100*l]}function hsv2cmyk(args){return rgb2cmyk(hsv2rgb(args))}function hsv2keyword(args){return rgb2keyword(hsv2rgb(args))}function cmyk2rgb(cmyk){var r,g,b,c=cmyk[0]/100,m=cmyk[1]/100,y=cmyk[2]/100,k=cmyk[3]/100;return r=1-Math.min(1,c*(1-k)+k),g=1-Math.min(1,m*(1-k)+k),b=1-Math.min(1,y*(1-k)+k),[255*r,255*g,255*b]}function cmyk2hsl(args){return rgb2hsl(cmyk2rgb(args))}function cmyk2hsv(args){return rgb2hsv(cmyk2rgb(args))}function cmyk2keyword(args){return rgb2keyword(cmyk2rgb(args))}function xyz2rgb(xyz){var r,g,b,x=xyz[0]/100,y=xyz[1]/100,z=xyz[2]/100;return r=3.2406*x+-1.5372*y+z*-.4986,g=x*-.9689+1.8758*y+.0415*z,b=.0557*x+y*-.204+1.057*z,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r=12.92*r,g=g>.0031308?1.055*Math.pow(g,1/2.4)-.055:g=12.92*g,b=b>.0031308?1.055*Math.pow(b,1/2.4)-.055:b=12.92*b,r=0>r?0:r,g=0>g?0:g,b=0>b?0:b,[255*r,255*g,255*b]}function keyword2rgb(keyword){return cssKeywords[keyword]}function keyword2hsl(args){return rgb2hsl(keyword2rgb(args))}function keyword2hsv(args){return rgb2hsv(keyword2rgb(args))}function keyword2cmyk(args){return rgb2cmyk(keyword2rgb(args))}module.exports={rgb2hsl:rgb2hsl,rgb2hsv:rgb2hsv,rgb2cmyk:rgb2cmyk,rgb2keyword:rgb2keyword,rgb2xyz:rgb2xyz,rgb2lab:rgb2lab,hsl2rgb:hsl2rgb,hsl2hsv:hsl2hsv,hsl2cmyk:hsl2cmyk,hsl2keyword:hsl2keyword,hsv2rgb:hsv2rgb,hsv2hsl:hsv2hsl,hsv2cmyk:hsv2cmyk,hsv2keyword:hsv2keyword,cmyk2rgb:cmyk2rgb,cmyk2hsl:cmyk2hsl,cmyk2hsv:cmyk2hsv,cmyk2keyword:cmyk2keyword,keyword2rgb:keyword2rgb,keyword2hsl:keyword2hsl,keyword2hsv:keyword2hsv,keyword2cmyk:keyword2cmyk,xyz2rgb:xyz2rgb};var cssKeywords={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},reverseKeywords={};for(var key in cssKeywords)reverseKeywords[JSON.stringify(cssKeywords[key])]=key},{}],35:[function(require,module,exports){var conversions=require("./conversions"),exports={};module.exports=exports;for(var func in conversions){exports[func+"Raw"]=function(func){return function(arg){return"number"==typeof arg&&(arg=Array.prototype.slice.call(arguments)),conversions[func](arg)}}(func);var pair=/(\w+)2(\w+)/.exec(func),from=pair[1],to=pair[2];exports[from]=exports[from]||{},exports[from][to]=exports[func]=function(func){return function(arg){"number"==typeof arg&&(arg=Array.prototype.slice.call(arguments));var val=conversions[func](arg);if("string"==typeof val||void 0===val)return val;for(var i=0;i<val.length;i++)val[i]=Math.round(val[i]);return val}}(func)}},{"./conversions":34}],36:[function(require,module){function getRgba(string){if(string){var abbr=/^#([a-fA-F0-9]{3})$/,hex=/^#([a-fA-F0-9]{6})$/,rgba=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*([\d\.]+)\s*)?\)$/,per=/^rgba?\(\s*([\d\.]+)\%\s*,\s*([\d\.]+)\%\s*,\s*([\d\.]+)\%\s*(?:,\s*([\d\.]+)\s*)?\)$/,keyword=/(\D+)/,rgb=[0,0,0],a=1,match=string.match(abbr);if(match){match=match[1];for(var i=0;i<rgb.length;i++)rgb[i]=parseInt(match[i]+match[i],16)}else if(match=string.match(hex)){match=match[1];for(var i=0;i<rgb.length;i++)rgb[i]=parseInt(match.slice(2*i,2*i+2),16)}else if(match=string.match(rgba)){for(var i=0;i<rgb.length;i++)rgb[i]=parseInt(match[i+1]);a=parseFloat(match[4])}else if(match=string.match(per)){for(var i=0;i<rgb.length;i++)rgb[i]=Math.round(2.55*parseFloat(match[i+1]));a=parseFloat(match[4])}else if(match=string.match(keyword)){if("transparent"==match[1])return[0,0,0,0];if(rgb=convert.keyword2rgb(match[1]),!rgb)return}for(var i=0;i<rgb.length;i++)rgb[i]=scale(rgb[i],0,255);return a=a||0==a?scale(a,0,1):1,rgb.push(a),rgb}}function getHsla(string){if(string){var hsl=/^hsla?\(\s*(\d+)\s*,\s*([\d\.]+)%\s*,\s*([\d\.]+)%\s*(?:,\s*([\d\.]+)\s*)?\)/,match=string.match(hsl);if(match){var h=scale(parseInt(match[1]),0,360),s=scale(parseFloat(match[2]),0,100),l=scale(parseFloat(match[3]),0,100),a=scale(parseFloat(match[4])||1,0,1);return[h,s,l,a]}}}function getRgb(string){return getRgba(string).slice(0,3)}function getHsl(string){return getHsla(string).slice(0,3)}function getAlpha(string){var vals=getRgba(string);return vals?vals[3]:(vals=getHsla(string))?vals[3]:void 0}function hexString(rgb){return"#"+hexDouble(rgb[0])+hexDouble(rgb[1])+hexDouble(rgb[2])}function rgbString(rgba,alpha){return 1>alpha||rgba[3]&&rgba[3]<1?rgbaString(rgba,alpha):"rgb("+rgba[0]+", "+rgba[1]+", "+rgba[2]+")"}function rgbaString(rgba,alpha){return void 0===alpha&&(alpha=void 0!==rgba[3]?rgba[3]:1),"rgba("+rgba[0]+", "+rgba[1]+", "+rgba[2]+", "+alpha+")"}function percentString(rgba,alpha){if(1>alpha||rgba[3]&&rgba[3]<1)return percentaString(rgba,alpha);var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgb("+r+"%, "+g+"%, "+b+"%)"}function percentaString(rgba,alpha){var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgba("+r+"%, "+g+"%, "+b+"%, "+(alpha||rgba[3]||1)+")"}function hslString(hsla,alpha){return 1>alpha||hsla[3]&&hsla[3]<1?hslaString(hsla,alpha):"hsl("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%)"}function hslaString(hsla,alpha){return void 0===alpha&&(alpha=void 0!==hsla[3]?hsla[3]:1),"hsla("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%, "+alpha+")"}function keyword(rgb){return convert.rgb2keyword(rgb.slice(0,3))}function scale(num,min,max){return Math.min(Math.max(min,num),max)}function hexDouble(num){var str=num.toString(16).toUpperCase();return str.length<2?"0"+str:str}var convert=require("color-convert");module.exports={getRgba:getRgba,getHsla:getHsla,getRgb:getRgb,getHsl:getHsl,getAlpha:getAlpha,hexString:hexString,rgbString:rgbString,rgbaString:rgbaString,percentString:percentString,percentaString:percentaString,hslString:hslString,hslaString:hslaString,keyword:keyword}},{"color-convert":35}],37:[function(require,module,exports){(function(process){!function(definition){if("function"==typeof bootstrap)bootstrap("promise",definition);else if("object"==typeof exports)module.exports=definition();else if("function"==typeof define&&define.amd)define(definition);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=definition}else Q=definition()}(function(){"use strict";function uncurryThis(f){return function(){return call.apply(f,arguments)}}function isObject(value){return value===Object(value)}function isStopIteration(exception){return"[object StopIteration]"===object_toString(exception)||exception instanceof QReturnValue}function makeStackTraceLong(error,promise){if(hasStacks&&promise.stack&&"object"==typeof error&&null!==error&&error.stack&&-1===error.stack.indexOf(STACK_JUMP_SEPARATOR)){for(var stacks=[],p=promise;p;p=p.source)p.stack&&stacks.unshift(p.stack);stacks.unshift(error.stack);var concatedStacks=stacks.join("\n"+STACK_JUMP_SEPARATOR+"\n");error.stack=filterStackString(concatedStacks)}}function filterStackString(stackString){for(var lines=stackString.split("\n"),desiredLines=[],i=0;i<lines.length;++i){var line=lines[i];isInternalFrame(line)||isNodeFrame(line)||!line||desiredLines.push(line)}return desiredLines.join("\n")}function isNodeFrame(stackLine){return-1!==stackLine.indexOf("(module.js:")||-1!==stackLine.indexOf("(node.js:")}function getFileNameAndLineNumber(stackLine){var attempt1=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(stackLine);if(attempt1)return[attempt1[1],Number(attempt1[2])];var attempt2=/at ([^ ]+):(\d+):(?:\d+)$/.exec(stackLine);if(attempt2)return[attempt2[1],Number(attempt2[2])];var attempt3=/.*@(.+):(\d+)$/.exec(stackLine);return attempt3?[attempt3[1],Number(attempt3[2])]:void 0}function isInternalFrame(stackLine){var fileNameAndLineNumber=getFileNameAndLineNumber(stackLine);if(!fileNameAndLineNumber)return!1;var fileName=fileNameAndLineNumber[0],lineNumber=fileNameAndLineNumber[1];return fileName===qFileName&&lineNumber>=qStartingLine&&qEndingLine>=lineNumber}function captureLine(){if(hasStacks)try{throw new Error}catch(e){var lines=e.stack.split("\n"),firstLine=lines[0].indexOf("@")>0?lines[1]:lines[2],fileNameAndLineNumber=getFileNameAndLineNumber(firstLine);if(!fileNameAndLineNumber)return;return qFileName=fileNameAndLineNumber[0],fileNameAndLineNumber[1]}}function deprecate(callback,name,alternative){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(name+" is deprecated, use "+alternative+" instead.",new Error("").stack),callback.apply(callback,arguments)}}function Q(value){return isPromise(value)?value:isPromiseAlike(value)?coerce(value):fulfill(value)}function defer(){function become(newPromise){resolvedPromise=newPromise,promise.source=newPromise,array_reduce(messages,function(undefined,message){nextTick(function(){newPromise.promiseDispatch.apply(newPromise,message)})},void 0),messages=void 0,progressListeners=void 0}var resolvedPromise,messages=[],progressListeners=[],deferred=object_create(defer.prototype),promise=object_create(Promise.prototype);if(promise.promiseDispatch=function(resolve,op,operands){var args=array_slice(arguments);messages?(messages.push(args),"when"===op&&operands[1]&&progressListeners.push(operands[1])):nextTick(function(){resolvedPromise.promiseDispatch.apply(resolvedPromise,args)})},promise.valueOf=function(){if(messages)return promise;var nearerValue=nearer(resolvedPromise);return isPromise(nearerValue)&&(resolvedPromise=nearerValue),nearerValue},promise.inspect=function(){return resolvedPromise?resolvedPromise.inspect():{state:"pending"}},Q.longStackSupport&&hasStacks)try{throw new Error}catch(e){promise.stack=e.stack.substring(e.stack.indexOf("\n")+1)}return deferred.promise=promise,deferred.resolve=function(value){resolvedPromise||become(Q(value))},deferred.fulfill=function(value){resolvedPromise||become(fulfill(value))},deferred.reject=function(reason){resolvedPromise||become(reject(reason))},deferred.notify=function(progress){resolvedPromise||array_reduce(progressListeners,function(undefined,progressListener){nextTick(function(){progressListener(progress)})},void 0)},deferred}function promise(resolver){if("function"!=typeof resolver)throw new TypeError("resolver must be a function.");var deferred=defer();try{resolver(deferred.resolve,deferred.reject,deferred.notify)}catch(reason){deferred.reject(reason)}return deferred.promise}function race(answerPs){return promise(function(resolve,reject){for(var i=0,len=answerPs.length;len>i;i++)Q(answerPs[i]).then(resolve,reject)})}function Promise(descriptor,fallback,inspect){void 0===fallback&&(fallback=function(op){return reject(new Error("Promise does not support operation: "+op))
}),void 0===inspect&&(inspect=function(){return{state:"unknown"}});var promise=object_create(Promise.prototype);if(promise.promiseDispatch=function(resolve,op,args){var result;try{result=descriptor[op]?descriptor[op].apply(promise,args):fallback.call(promise,op,args)}catch(exception){result=reject(exception)}resolve&&resolve(result)},promise.inspect=inspect,inspect){var inspected=inspect();"rejected"===inspected.state&&(promise.exception=inspected.reason),promise.valueOf=function(){var inspected=inspect();return"pending"===inspected.state||"rejected"===inspected.state?promise:inspected.value}}return promise}function when(value,fulfilled,rejected,progressed){return Q(value).then(fulfilled,rejected,progressed)}function nearer(value){if(isPromise(value)){var inspected=value.inspect();if("fulfilled"===inspected.state)return inspected.value}return value}function isPromise(object){return isObject(object)&&"function"==typeof object.promiseDispatch&&"function"==typeof object.inspect}function isPromiseAlike(object){return isObject(object)&&"function"==typeof object.then}function isPending(object){return isPromise(object)&&"pending"===object.inspect().state}function isFulfilled(object){return!isPromise(object)||"fulfilled"===object.inspect().state}function isRejected(object){return isPromise(object)&&"rejected"===object.inspect().state}function displayUnhandledReasons(){!unhandledReasonsDisplayed&&"undefined"!=typeof window&&window.console&&console.warn("[Q] Unhandled rejection reasons (should be empty):",unhandledReasons),unhandledReasonsDisplayed=!0}function logUnhandledReasons(){for(var i=0;i<unhandledReasons.length;i++){var reason=unhandledReasons[i];console.warn("Unhandled rejection reason:",reason)}}function resetUnhandledRejections(){unhandledReasons.length=0,unhandledRejections.length=0,unhandledReasonsDisplayed=!1,trackUnhandledRejections||(trackUnhandledRejections=!0,"undefined"!=typeof process&&process.on&&process.on("exit",logUnhandledReasons))}function trackRejection(promise,reason){trackUnhandledRejections&&(unhandledRejections.push(promise),unhandledReasons.push(reason&&"undefined"!=typeof reason.stack?reason.stack:"(no stack) "+reason),displayUnhandledReasons())}function untrackRejection(promise){if(trackUnhandledRejections){var at=array_indexOf(unhandledRejections,promise);-1!==at&&(unhandledRejections.splice(at,1),unhandledReasons.splice(at,1))}}function reject(reason){var rejection=Promise({when:function(rejected){return rejected&&untrackRejection(this),rejected?rejected(reason):this}},function(){return this},function(){return{state:"rejected",reason:reason}});return trackRejection(rejection,reason),rejection}function fulfill(value){return Promise({when:function(){return value},get:function(name){return value[name]},set:function(name,rhs){value[name]=rhs},"delete":function(name){delete value[name]},post:function(name,args){return null===name||void 0===name?value.apply(void 0,args):value[name].apply(value,args)},apply:function(thisp,args){return value.apply(thisp,args)},keys:function(){return object_keys(value)}},void 0,function(){return{state:"fulfilled",value:value}})}function coerce(promise){var deferred=defer();return nextTick(function(){try{promise.then(deferred.resolve,deferred.reject,deferred.notify)}catch(exception){deferred.reject(exception)}}),deferred.promise}function master(object){return Promise({isDef:function(){}},function(op,args){return dispatch(object,op,args)},function(){return Q(object).inspect()})}function spread(value,fulfilled,rejected){return Q(value).spread(fulfilled,rejected)}function async(makeGenerator){return function(){function continuer(verb,arg){var result;if(hasES6Generators){try{result=generator[verb](arg)}catch(exception){return reject(exception)}return result.done?result.value:when(result.value,callback,errback)}try{result=generator[verb](arg)}catch(exception){return isStopIteration(exception)?exception.value:reject(exception)}return when(result,callback,errback)}var generator=makeGenerator.apply(this,arguments),callback=continuer.bind(continuer,"next"),errback=continuer.bind(continuer,"throw");return callback()}}function spawn(makeGenerator){Q.done(Q.async(makeGenerator)())}function _return(value){throw new QReturnValue(value)}function promised(callback){return function(){return spread([this,all(arguments)],function(self,args){return callback.apply(self,args)})}}function dispatch(object,op,args){return Q(object).dispatch(op,args)}function all(promises){return when(promises,function(promises){var countDown=0,deferred=defer();return array_reduce(promises,function(undefined,promise,index){var snapshot;isPromise(promise)&&"fulfilled"===(snapshot=promise.inspect()).state?promises[index]=snapshot.value:(++countDown,when(promise,function(value){promises[index]=value,0===--countDown&&deferred.resolve(promises)},deferred.reject,function(progress){deferred.notify({index:index,value:progress})}))},void 0),0===countDown&&deferred.resolve(promises),deferred.promise})}function allResolved(promises){return when(promises,function(promises){return promises=array_map(promises,Q),when(all(array_map(promises,function(promise){return when(promise,noop,noop)})),function(){return promises})})}function allSettled(promises){return Q(promises).allSettled()}function progress(object,progressed){return Q(object).then(void 0,void 0,progressed)}function nodeify(object,nodeback){return Q(object).nodeify(nodeback)}var hasStacks=!1;try{throw new Error}catch(e){hasStacks=!!e.stack}var qFileName,QReturnValue,qStartingLine=captureLine(),noop=function(){},nextTick=function(){function flush(){for(;head.next;){head=head.next;var task=head.task;head.task=void 0;var domain=head.domain;domain&&(head.domain=void 0,domain.enter());try{task()}catch(e){if(isNodeJS)throw domain&&domain.exit(),setTimeout(flush,0),domain&&domain.enter(),e;setTimeout(function(){throw e},0)}domain&&domain.exit()}flushing=!1}var head={task:void 0,next:null},tail=head,flushing=!1,requestTick=void 0,isNodeJS=!1;if(nextTick=function(task){tail=tail.next={task:task,domain:isNodeJS&&process.domain,next:null},flushing||(flushing=!0,requestTick())},"undefined"!=typeof process&&process.nextTick)isNodeJS=!0,requestTick=function(){process.nextTick(flush)};else if("function"==typeof setImmediate)requestTick="undefined"!=typeof window?setImmediate.bind(window,flush):function(){setImmediate(flush)};else if("undefined"!=typeof MessageChannel){var channel=new MessageChannel;channel.port1.onmessage=function(){requestTick=requestPortTick,channel.port1.onmessage=flush,flush()};var requestPortTick=function(){channel.port2.postMessage(0)};requestTick=function(){setTimeout(flush,0),requestPortTick()}}else requestTick=function(){setTimeout(flush,0)};return nextTick}(),call=Function.call,array_slice=uncurryThis(Array.prototype.slice),array_reduce=uncurryThis(Array.prototype.reduce||function(callback,basis){var index=0,length=this.length;if(1===arguments.length)for(;;){if(index in this){basis=this[index++];break}if(++index>=length)throw new TypeError}for(;length>index;index++)index in this&&(basis=callback(basis,this[index],index));return basis}),array_indexOf=uncurryThis(Array.prototype.indexOf||function(value){for(var i=0;i<this.length;i++)if(this[i]===value)return i;return-1}),array_map=uncurryThis(Array.prototype.map||function(callback,thisp){var self=this,collect=[];return array_reduce(self,function(undefined,value,index){collect.push(callback.call(thisp,value,index,self))},void 0),collect}),object_create=Object.create||function(prototype){function Type(){}return Type.prototype=prototype,new Type},object_hasOwnProperty=uncurryThis(Object.prototype.hasOwnProperty),object_keys=Object.keys||function(object){var keys=[];for(var key in object)object_hasOwnProperty(object,key)&&keys.push(key);return keys},object_toString=uncurryThis(Object.prototype.toString);QReturnValue="undefined"!=typeof ReturnValue?ReturnValue:function(value){this.value=value};var hasES6Generators;try{new Function("(function* (){ yield 1; })"),hasES6Generators=!0}catch(e){hasES6Generators=!1}var STACK_JUMP_SEPARATOR="From previous event:";Q.resolve=Q,Q.nextTick=nextTick,Q.longStackSupport=!1,Q.defer=defer,defer.prototype.makeNodeResolver=function(){var self=this;return function(error,value){error?self.reject(error):self.resolve(arguments.length>2?array_slice(arguments,1):value)}},Q.promise=promise,Q.passByCopy=function(object){return object},Promise.prototype.passByCopy=function(){return this},Q.join=function(x,y){return Q(x).join(y)},Promise.prototype.join=function(that){return Q([this,that]).spread(function(x,y){if(x===y)return x;throw new Error("Can't join: not the same: "+x+" "+y)})},Q.race=race,Promise.prototype.race=function(){return this.then(Q.race)},Q.makePromise=Promise,Promise.prototype.toString=function(){return"[object Promise]"},Promise.prototype.then=function(fulfilled,rejected,progressed){function _fulfilled(value){try{return"function"==typeof fulfilled?fulfilled(value):value}catch(exception){return reject(exception)}}function _rejected(exception){if("function"==typeof rejected){makeStackTraceLong(exception,self);try{return rejected(exception)}catch(newException){return reject(newException)}}return reject(exception)}function _progressed(value){return"function"==typeof progressed?progressed(value):value}var self=this,deferred=defer(),done=!1;return nextTick(function(){self.promiseDispatch(function(value){done||(done=!0,deferred.resolve(_fulfilled(value)))},"when",[function(exception){done||(done=!0,deferred.resolve(_rejected(exception)))}])}),self.promiseDispatch(void 0,"when",[void 0,function(value){var newValue,threw=!1;try{newValue=_progressed(value)}catch(e){if(threw=!0,!Q.onerror)throw e;Q.onerror(e)}threw||deferred.notify(newValue)}]),deferred.promise},Q.when=when,Promise.prototype.thenResolve=function(value){return this.then(function(){return value})},Q.thenResolve=function(promise,value){return Q(promise).thenResolve(value)},Promise.prototype.thenReject=function(reason){return this.then(function(){throw reason})},Q.thenReject=function(promise,reason){return Q(promise).thenReject(reason)},Q.nearer=nearer,Q.isPromise=isPromise,Q.isPromiseAlike=isPromiseAlike,Q.isPending=isPending,Promise.prototype.isPending=function(){return"pending"===this.inspect().state},Q.isFulfilled=isFulfilled,Promise.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},Q.isRejected=isRejected,Promise.prototype.isRejected=function(){return"rejected"===this.inspect().state};var unhandledReasons=[],unhandledRejections=[],unhandledReasonsDisplayed=!1,trackUnhandledRejections=!0;Q.resetUnhandledRejections=resetUnhandledRejections,Q.getUnhandledReasons=function(){return unhandledReasons.slice()},Q.stopUnhandledRejectionTracking=function(){resetUnhandledRejections(),"undefined"!=typeof process&&process.on&&process.removeListener("exit",logUnhandledReasons),trackUnhandledRejections=!1},resetUnhandledRejections(),Q.reject=reject,Q.fulfill=fulfill,Q.master=master,Q.spread=spread,Promise.prototype.spread=function(fulfilled,rejected){return this.all().then(function(array){return fulfilled.apply(void 0,array)},rejected)},Q.async=async,Q.spawn=spawn,Q["return"]=_return,Q.promised=promised,Q.dispatch=dispatch,Promise.prototype.dispatch=function(op,args){var self=this,deferred=defer();return nextTick(function(){self.promiseDispatch(deferred.resolve,op,args)}),deferred.promise},Q.get=function(object,key){return Q(object).dispatch("get",[key])},Promise.prototype.get=function(key){return this.dispatch("get",[key])},Q.set=function(object,key,value){return Q(object).dispatch("set",[key,value])},Promise.prototype.set=function(key,value){return this.dispatch("set",[key,value])},Q.del=Q["delete"]=function(object,key){return Q(object).dispatch("delete",[key])},Promise.prototype.del=Promise.prototype["delete"]=function(key){return this.dispatch("delete",[key])},Q.mapply=Q.post=function(object,name,args){return Q(object).dispatch("post",[name,args])},Promise.prototype.mapply=Promise.prototype.post=function(name,args){return this.dispatch("post",[name,args])},Q.send=Q.mcall=Q.invoke=function(object,name){return Q(object).dispatch("post",[name,array_slice(arguments,2)])},Promise.prototype.send=Promise.prototype.mcall=Promise.prototype.invoke=function(name){return this.dispatch("post",[name,array_slice(arguments,1)])},Q.fapply=function(object,args){return Q(object).dispatch("apply",[void 0,args])},Promise.prototype.fapply=function(args){return this.dispatch("apply",[void 0,args])},Q["try"]=Q.fcall=function(object){return Q(object).dispatch("apply",[void 0,array_slice(arguments,1)])},Promise.prototype.fcall=function(){return this.dispatch("apply",[void 0,array_slice(arguments)])},Q.fbind=function(object){var promise=Q(object),args=array_slice(arguments,1);return function(){return promise.dispatch("apply",[this,args.concat(array_slice(arguments))])}},Promise.prototype.fbind=function(){var promise=this,args=array_slice(arguments);return function(){return promise.dispatch("apply",[this,args.concat(array_slice(arguments))])}},Q.keys=function(object){return Q(object).dispatch("keys",[])},Promise.prototype.keys=function(){return this.dispatch("keys",[])},Q.all=all,Promise.prototype.all=function(){return all(this)},Q.allResolved=deprecate(allResolved,"allResolved","allSettled"),Promise.prototype.allResolved=function(){return allResolved(this)},Q.allSettled=allSettled,Promise.prototype.allSettled=function(){return this.then(function(promises){return all(array_map(promises,function(promise){function regardless(){return promise.inspect()}return promise=Q(promise),promise.then(regardless,regardless)}))})},Q.fail=Q["catch"]=function(object,rejected){return Q(object).then(void 0,rejected)},Promise.prototype.fail=Promise.prototype["catch"]=function(rejected){return this.then(void 0,rejected)},Q.progress=progress,Promise.prototype.progress=function(progressed){return this.then(void 0,void 0,progressed)},Q.fin=Q["finally"]=function(object,callback){return Q(object)["finally"](callback)},Promise.prototype.fin=Promise.prototype["finally"]=function(callback){return callback=Q(callback),this.then(function(value){return callback.fcall().then(function(){return value})},function(reason){return callback.fcall().then(function(){throw reason})})},Q.done=function(object,fulfilled,rejected,progress){return Q(object).done(fulfilled,rejected,progress)},Promise.prototype.done=function(fulfilled,rejected,progress){var onUnhandledError=function(error){nextTick(function(){if(makeStackTraceLong(error,promise),!Q.onerror)throw error;Q.onerror(error)})},promise=fulfilled||rejected||progress?this.then(fulfilled,rejected,progress):this;"object"==typeof process&&process&&process.domain&&(onUnhandledError=process.domain.bind(onUnhandledError)),promise.then(void 0,onUnhandledError)},Q.timeout=function(object,ms,message){return Q(object).timeout(ms,message)},Promise.prototype.timeout=function(ms,message){var deferred=defer(),timeoutId=setTimeout(function(){deferred.reject(new Error(message||"Timed out after "+ms+" ms"))},ms);return this.then(function(value){clearTimeout(timeoutId),deferred.resolve(value)},function(exception){clearTimeout(timeoutId),deferred.reject(exception)},deferred.notify),deferred.promise},Q.delay=function(object,timeout){return void 0===timeout&&(timeout=object,object=void 0),Q(object).delay(timeout)},Promise.prototype.delay=function(timeout){return this.then(function(value){var deferred=defer();return setTimeout(function(){deferred.resolve(value)},timeout),deferred.promise})},Q.nfapply=function(callback,args){return Q(callback).nfapply(args)},Promise.prototype.nfapply=function(args){var deferred=defer(),nodeArgs=array_slice(args);return nodeArgs.push(deferred.makeNodeResolver()),this.fapply(nodeArgs).fail(deferred.reject),deferred.promise},Q.nfcall=function(callback){var args=array_slice(arguments,1);return Q(callback).nfapply(args)},Promise.prototype.nfcall=function(){var nodeArgs=array_slice(arguments),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),this.fapply(nodeArgs).fail(deferred.reject),deferred.promise},Q.nfbind=Q.denodeify=function(callback){var baseArgs=array_slice(arguments,1);return function(){var nodeArgs=baseArgs.concat(array_slice(arguments)),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),Q(callback).fapply(nodeArgs).fail(deferred.reject),deferred.promise}},Promise.prototype.nfbind=Promise.prototype.denodeify=function(){var args=array_slice(arguments);return args.unshift(this),Q.denodeify.apply(void 0,args)},Q.nbind=function(callback,thisp){var baseArgs=array_slice(arguments,2);return function(){function bound(){return callback.apply(thisp,arguments)}var nodeArgs=baseArgs.concat(array_slice(arguments)),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),Q(bound).fapply(nodeArgs).fail(deferred.reject),deferred.promise}},Promise.prototype.nbind=function(){var args=array_slice(arguments,0);return args.unshift(this),Q.nbind.apply(void 0,args)},Q.nmapply=Q.npost=function(object,name,args){return Q(object).npost(name,args)},Promise.prototype.nmapply=Promise.prototype.npost=function(name,args){var nodeArgs=array_slice(args||[]),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),this.dispatch("post",[name,nodeArgs]).fail(deferred.reject),deferred.promise},Q.nsend=Q.nmcall=Q.ninvoke=function(object,name){var nodeArgs=array_slice(arguments,2),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),Q(object).dispatch("post",[name,nodeArgs]).fail(deferred.reject),deferred.promise},Promise.prototype.nsend=Promise.prototype.nmcall=Promise.prototype.ninvoke=function(name){var nodeArgs=array_slice(arguments,1),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),this.dispatch("post",[name,nodeArgs]).fail(deferred.reject),deferred.promise},Q.nodeify=nodeify,Promise.prototype.nodeify=function(nodeback){return nodeback?void this.then(function(value){nextTick(function(){nodeback(null,value)})},function(error){nextTick(function(){nodeback(error)})}):this};var qEndingLine=captureLine();return Q})}).call(this,require("_process"))},{_process:8}],38:[function(require,module,exports){!function(definition){"object"==typeof exports?module.exports=definition():window.QanimationFrame=definition()}(function(){"use strict";var Q=window.Q||require("q"),requestAnimationFrame=function(){return window.requestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}(),QanimationFrame=function(f){var d=Q.defer();return requestAnimationFrame(function(){try{d.resolve(f())}catch(e){d.reject(e)}}),d.promise};return QanimationFrame})},{q:37}],39:[function(require,module){"use strict";function get(key){return key in memo?memo[key]:memo[key]=prefix(key)}function prefix(key){var name,capitalizedKey=key.replace(/-([a-z])/g,function(s,match){return match.toUpperCase()}),i=prefixes.length;if(void 0!==style[capitalizedKey])return capitalizedKey;for(capitalizedKey=capitalize(key);i--;)if(name=prefixes[i]+capitalizedKey,void 0!==style[name])return name;throw new Error("unable to prefix "+key)}function capitalize(str){return str.charAt(0).toUpperCase()+str.slice(1)}function dashedPrefix(key){var prefixedKey=get(key),upper=/([A-Z])/g;return upper.test(prefixedKey)&&(prefixedKey=(hasPrefix.test(prefixedKey)?"-":"")+prefixedKey.replace(upper,"-$1")),prefixedKey.toLowerCase()}var style=document.createElement("p").style,prefixes="O ms Moz webkit".split(" "),hasPrefix=/^(o|ms|moz|webkit)/,memo={};module.exports=get,module.exports.dash=dashedPrefix},{}],40:[function(require,module){"use strict";var Q=require("q"),QanimationFrame=require("qanimationframe"),prefix=require("vendor-prefix"),normalizeTransformValue=require("../src/normalize-transform-value"),shorthand=require("../src/transition-shorthand-property"),transition=prefix("transition"),transitionend="WebkitTransition"in document.body.style?"webkitTransitionEnd":"transitionend",isDOM=function(el){try{return el&&el.nodeType}catch(err){return!1}},addTransition=function(elt,attr,value,duration,easing){var currentValue=elt.style[transition];attr=prefix.dash(attr),elt.style[transition]=currentValue?currentValue+", "+shorthand(attr,duration,easing):shorthand(attr,duration,easing),elt.style[prefix(attr)]=value},removeTransition=function(el,attr){el.style[transition]=el.style[transition].split(",").filter(function(t){return!t.match(attr)}).join(",")},applycss=function(el,attr,value){return QanimationFrame(function(){return el.style[prefix.dash(attr)]=value,el})},css=function(el,attr,value){return el._zanimo&&el._zanimo.hasOwnProperty(attr)&&(el._zanimo[attr].defer.reject(new Error("Zanimo transition with transform="+el._zanimo[attr].value+" stopped by transform="+value)),el._zanimo[attr].cb()),applycss(el,attr,value)},animate=function(el,attr,value,duration,easing){var timeout,prefixed=prefix.dash(attr),d=Q.defer(),cb=function(clear){timeout&&(clearTimeout(timeout),timeout=null),removeTransition(el,attr),el.removeEventListener(transitionend,cbTransitionend),clear&&delete el._zanimo[attr]},cbTransitionend=function(evt){prefix(evt.propertyName)===prefix(prefixed)&&(cb(!0),d.resolve(el))};return el.addEventListener(transitionend,cbTransitionend),QanimationFrame(function(){addTransition(el,attr,normalizeTransformValue(value),duration,easing),timeout=setTimeout(function(){var rawVal=el.style.getPropertyValue(prefixed),domVal=normalizeTransformValue(rawVal),givenVal=normalizeTransformValue(value);cb(!0),domVal===givenVal?d.resolve(el):d.reject(new Error("Zanimo transition: with "+attr+" = "+givenVal+", DOM value="+domVal))},duration+20),el._zanimo=el._zanimo||{},el._zanimo[attr]&&(el._zanimo[attr].defer.reject(new Error("Zanimo transition with "+attr+"="+el._zanimo[attr].value+" stopped by transition with "+attr+"="+value)),el._zanimo[attr].cb()),el._zanimo[attr]={cb:cb,value:value,defer:d}}),d.promise},Zanimo=function(el,attr,value,duration,easing){var args=arguments,arity=arguments.length;if(0===arity||2===arity||arity>5)return Q.reject(new Error("Zanimo invalid arguments"));if(Q.isPromise(el))return el.then(function(val){return Zanimo.apply(this,[val].concat(Array.prototype.slice.call(args,1)))});if(!isDOM(el))return Q.reject(new Error("Zanimo require an HTMLElement, or a promise of an HTMLElement"));if(1===arity)return Q(el);try{prefix.dash(attr)}catch(err){return Q.reject(new Error("Zanimo transition: "+attr+" is not supported!"))}return 3===arity?css(el,attr,value):window.isNaN(parseInt(duration,10))?Q.reject(new Error("Zanimo transition: duration must be an integer!")):animate(el,attr,value,duration,easing)};Zanimo.f=function(){var args=Array.prototype.slice.call(arguments);return function(el){return Zanimo.apply(this,[el].concat(args))}},module.exports=Zanimo},{"../src/normalize-transform-value":42,"../src/transition-shorthand-property":43,q:47,qanimationframe:38,"vendor-prefix":39}],41:[function(require,module){"use strict";var matchParenthesis=/(\(.+?\))/g,space=/ +/g,emptyString="",whitespace=" ",normalize=function(match){var args=match.substr(1,match.length-2).split(","),rst=args.map(function(arg){return parseFloat(arg.replace(space,emptyString))});return"("+rst.join(",")+")"};module.exports=function(t){return"string"==typeof t?t.replace(space,whitespace).replace(matchParenthesis,normalize):t}},{}],42:[function(require,module){"use strict";var Color=require("color"),matchParenthesis=/(\(.+?\))/g,matchColors=/(\brgba\b|\bhsl\b|\bhsla\b)(\(.+?\))/g,space=/ +/g,emptyString="",whitespace=" ",zeropixel=/^0px$/g,zero="0",normArgs=function(match){var args=match.substr(1,match.length-2).split(","),rst=args.map(function(arg){return arg.replace(space,emptyString).replace(zeropixel,zero)});return"("+rst.join(",")+")"},normColors=function(match){var c=Color(match);return c.alpha()&&c.alpha(Math.round(10*c.alpha())/10),c.rgbString()},normalize=function(val){return val.replace(space,whitespace).replace(matchColors,normColors).replace(matchParenthesis,normArgs)};module.exports=function(val){return null===val||void 0===val?emptyString:window.isNaN(val)?normalize(val):val.toString()}},{color:33}],43:[function(require,module){"use strict";var prefix=require("vendor-prefix"),normalizeTransformValue=require("./normalize-transform-value"),normalizeTimingFunction=require("./normalize-timing-function"),transition=prefix.dash("transition"),el=document.createElement("div"),test="opacity 100ms linear 0s",normalizedTest=normalizeTransformValue(test),shorthand=function(v,d,t){return v+" "+d+"ms "+(t||"linear")};el.style[transition]=normalizedTest,normalizeTransformValue(el.style[transition])===normalizedTest&&(shorthand=function(v,d,t){return v+" "+d+"ms "+(normalizeTimingFunction(t)||"linear")+" 0s"}),module.exports=shorthand},{"./normalize-timing-function":41,"./normalize-transform-value":42,"vendor-prefix":39}],44:[function(require,module){function KenBurnsWebGLTrait(canvas){this.canvas=canvas;var gl=this.gl=canvas.getContext("webgl"),program=this.program=gl.createProgram(),vertexShader=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(vertexShader,vertexShaderSource),gl.compileShader(vertexShader),gl.attachShader(program,vertexShader);var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(fragmentShader,fragmentShaderSource),gl.compileShader(fragmentShader),gl.attachShader(program,fragmentShader),gl.linkProgram(program),gl.useProgram(program),this.positionLocation=gl.getAttribLocation(program,"p"),this.imgResL=gl.getUniformLocation(program,"imgRes"),this.posL=gl.getUniformLocation(program,"pos"),this.dimL=gl.getUniformLocation(program,"dim"),this.bgL=gl.getUniformLocation(program,"bg"),this.buffer=gl.createBuffer()}var KenBurnsCore=require("kenburns-core"),vertexShaderSource="uniform vec2 imgRes;uniform vec2 pos;uniform vec2 dim;attribute vec2 p;varying vec2 uv;void main() {uv = pos/imgRes + ((p * vec2(1.,-1.)+1.)/2.) * (dim/imgRes);gl_Position = vec4(p,0.,1.);}",fragmentShaderSource="#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D img;uniform vec3 bg;varying vec2 uv;void main() {if(uv.x<0.||uv.x>1.||uv.y<0.||uv.y>1.)gl_FragColor = vec4(bg, 1.0);else gl_FragColor = texture2D(img, uv);}";KenBurnsWebGLTrait.prototype={runStart:function(image){{var gl=this.gl;this.canvas}gl.useProgram(this.program),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),gl.STATIC_DRAW);var positionLocation=this.positionLocation;gl.enableVertexAttribArray(positionLocation),gl.vertexAttribPointer(positionLocation,2,gl.FLOAT,!1,0,0),gl.uniform2f(this.imgResL,image.width,image.height),gl.uniform3fv(this.bgL,this.rgb);var texture=this.texture=gl.createTexture();gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,texture),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!1),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,image)},runEnd:function(){this.gl.deleteTexture(this.texture)},draw:function(image,bound){var gl=this.gl;gl.uniform2f(this.posL,bound[0],bound[1]),gl.uniform2f(this.dimL,bound[2],bound[3]),gl.drawArrays(gl.TRIANGLES,0,6)},destroy:function(){this.gl.deleteBuffer(this.buffer),this.gl.deleteProgram(this.program)},getViewport:function(){return this.canvas}},module.exports=KenBurnsCore.mixin(KenBurnsWebGLTrait)},{"kenburns-core":27}],45:[function(require,module){module.exports=function(rect,bounds){var w=rect[2],h=rect[3],maxWidth=bounds[2],maxHeight=bounds[3],ratio=w/h;return w>maxWidth&&(w=maxWidth,h=~~(w/ratio)),h>maxHeight&&(h=maxHeight,w=~~(h*ratio)),[bounds[0]+Math.max(0,Math.min(rect[0],maxWidth-w)),bounds[1]+Math.max(0,Math.min(rect[1],maxHeight-h)),w,h]}},{}],46:[function(require,module){function rectCrop(zoom,center){return center||(center=[.5,.5]),function(viewport,dimension){var viewportRatio=viewport.width/viewport.height,dimensionRatio=dimension.width/dimension.height,maxRatio=Math.max(viewportRatio,dimensionRatio),zoomedCanvasSize=[viewportRatio/maxRatio*dimension.width*zoom,dimensionRatio/maxRatio*dimension.height*zoom];return[dimension.width*center[0]-zoomedCanvasSize[0]/2,dimension.height*center[1]-zoomedCanvasSize[1]/2,zoomedCanvasSize[0],zoomedCanvasSize[1]]}}rectCrop.largest=rectCrop(1),module.exports=rectCrop},{}],47:[function(require,module,exports){(function(process){!function(definition){if("function"==typeof bootstrap)bootstrap("promise",definition);else if("object"==typeof exports)module.exports=definition();else if("function"==typeof define&&define.amd)define(definition);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=definition}else Q=definition()}(function(){"use strict";function uncurryThis(f){return function(){return call.apply(f,arguments)}}function isObject(value){return value===Object(value)}function isStopIteration(exception){return"[object StopIteration]"===object_toString(exception)||exception instanceof QReturnValue}function makeStackTraceLong(error,promise){if(hasStacks&&promise.stack&&"object"==typeof error&&null!==error&&error.stack&&-1===error.stack.indexOf(STACK_JUMP_SEPARATOR)){for(var stacks=[],p=promise;p;p=p.source)p.stack&&stacks.unshift(p.stack);stacks.unshift(error.stack);var concatedStacks=stacks.join("\n"+STACK_JUMP_SEPARATOR+"\n");error.stack=filterStackString(concatedStacks)}}function filterStackString(stackString){for(var lines=stackString.split("\n"),desiredLines=[],i=0;i<lines.length;++i){var line=lines[i];isInternalFrame(line)||isNodeFrame(line)||!line||desiredLines.push(line)}return desiredLines.join("\n")}function isNodeFrame(stackLine){return-1!==stackLine.indexOf("(module.js:")||-1!==stackLine.indexOf("(node.js:")}function getFileNameAndLineNumber(stackLine){var attempt1=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(stackLine);if(attempt1)return[attempt1[1],Number(attempt1[2])];var attempt2=/at ([^ ]+):(\d+):(?:\d+)$/.exec(stackLine);if(attempt2)return[attempt2[1],Number(attempt2[2])];var attempt3=/.*@(.+):(\d+)$/.exec(stackLine);return attempt3?[attempt3[1],Number(attempt3[2])]:void 0}function isInternalFrame(stackLine){var fileNameAndLineNumber=getFileNameAndLineNumber(stackLine);if(!fileNameAndLineNumber)return!1;var fileName=fileNameAndLineNumber[0],lineNumber=fileNameAndLineNumber[1];return fileName===qFileName&&lineNumber>=qStartingLine&&qEndingLine>=lineNumber}function captureLine(){if(hasStacks)try{throw new Error}catch(e){var lines=e.stack.split("\n"),firstLine=lines[0].indexOf("@")>0?lines[1]:lines[2],fileNameAndLineNumber=getFileNameAndLineNumber(firstLine);if(!fileNameAndLineNumber)return;return qFileName=fileNameAndLineNumber[0],fileNameAndLineNumber[1]}}function deprecate(callback,name,alternative){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(name+" is deprecated, use "+alternative+" instead.",new Error("").stack),callback.apply(callback,arguments)}}function Q(value){return isPromise(value)?value:isPromiseAlike(value)?coerce(value):fulfill(value)}function defer(){function become(newPromise){resolvedPromise=newPromise,promise.source=newPromise,array_reduce(messages,function(undefined,message){nextTick(function(){newPromise.promiseDispatch.apply(newPromise,message)})},void 0),messages=void 0,progressListeners=void 0}var resolvedPromise,messages=[],progressListeners=[],deferred=object_create(defer.prototype),promise=object_create(Promise.prototype);if(promise.promiseDispatch=function(resolve,op,operands){var args=array_slice(arguments);messages?(messages.push(args),"when"===op&&operands[1]&&progressListeners.push(operands[1])):nextTick(function(){resolvedPromise.promiseDispatch.apply(resolvedPromise,args)
})},promise.valueOf=function(){if(messages)return promise;var nearerValue=nearer(resolvedPromise);return isPromise(nearerValue)&&(resolvedPromise=nearerValue),nearerValue},promise.inspect=function(){return resolvedPromise?resolvedPromise.inspect():{state:"pending"}},Q.longStackSupport&&hasStacks)try{throw new Error}catch(e){promise.stack=e.stack.substring(e.stack.indexOf("\n")+1)}return deferred.promise=promise,deferred.resolve=function(value){resolvedPromise||become(Q(value))},deferred.fulfill=function(value){resolvedPromise||become(fulfill(value))},deferred.reject=function(reason){resolvedPromise||become(reject(reason))},deferred.notify=function(progress){resolvedPromise||array_reduce(progressListeners,function(undefined,progressListener){nextTick(function(){progressListener(progress)})},void 0)},deferred}function promise(resolver){if("function"!=typeof resolver)throw new TypeError("resolver must be a function.");var deferred=defer();try{resolver(deferred.resolve,deferred.reject,deferred.notify)}catch(reason){deferred.reject(reason)}return deferred.promise}function race(answerPs){return promise(function(resolve,reject){for(var i=0,len=answerPs.length;len>i;i++)Q(answerPs[i]).then(resolve,reject)})}function Promise(descriptor,fallback,inspect){void 0===fallback&&(fallback=function(op){return reject(new Error("Promise does not support operation: "+op))}),void 0===inspect&&(inspect=function(){return{state:"unknown"}});var promise=object_create(Promise.prototype);if(promise.promiseDispatch=function(resolve,op,args){var result;try{result=descriptor[op]?descriptor[op].apply(promise,args):fallback.call(promise,op,args)}catch(exception){result=reject(exception)}resolve&&resolve(result)},promise.inspect=inspect,inspect){var inspected=inspect();"rejected"===inspected.state&&(promise.exception=inspected.reason),promise.valueOf=function(){var inspected=inspect();return"pending"===inspected.state||"rejected"===inspected.state?promise:inspected.value}}return promise}function when(value,fulfilled,rejected,progressed){return Q(value).then(fulfilled,rejected,progressed)}function nearer(value){if(isPromise(value)){var inspected=value.inspect();if("fulfilled"===inspected.state)return inspected.value}return value}function isPromise(object){return isObject(object)&&"function"==typeof object.promiseDispatch&&"function"==typeof object.inspect}function isPromiseAlike(object){return isObject(object)&&"function"==typeof object.then}function isPending(object){return isPromise(object)&&"pending"===object.inspect().state}function isFulfilled(object){return!isPromise(object)||"fulfilled"===object.inspect().state}function isRejected(object){return isPromise(object)&&"rejected"===object.inspect().state}function resetUnhandledRejections(){unhandledReasons.length=0,unhandledRejections.length=0,trackUnhandledRejections||(trackUnhandledRejections=!0)}function trackRejection(promise,reason){trackUnhandledRejections&&(unhandledRejections.push(promise),unhandledReasons.push(reason&&"undefined"!=typeof reason.stack?reason.stack:"(no stack) "+reason))}function untrackRejection(promise){if(trackUnhandledRejections){var at=array_indexOf(unhandledRejections,promise);-1!==at&&(unhandledRejections.splice(at,1),unhandledReasons.splice(at,1))}}function reject(reason){var rejection=Promise({when:function(rejected){return rejected&&untrackRejection(this),rejected?rejected(reason):this}},function(){return this},function(){return{state:"rejected",reason:reason}});return trackRejection(rejection,reason),rejection}function fulfill(value){return Promise({when:function(){return value},get:function(name){return value[name]},set:function(name,rhs){value[name]=rhs},"delete":function(name){delete value[name]},post:function(name,args){return null===name||void 0===name?value.apply(void 0,args):value[name].apply(value,args)},apply:function(thisp,args){return value.apply(thisp,args)},keys:function(){return object_keys(value)}},void 0,function(){return{state:"fulfilled",value:value}})}function coerce(promise){var deferred=defer();return nextTick(function(){try{promise.then(deferred.resolve,deferred.reject,deferred.notify)}catch(exception){deferred.reject(exception)}}),deferred.promise}function master(object){return Promise({isDef:function(){}},function(op,args){return dispatch(object,op,args)},function(){return Q(object).inspect()})}function spread(value,fulfilled,rejected){return Q(value).spread(fulfilled,rejected)}function async(makeGenerator){return function(){function continuer(verb,arg){var result;if("undefined"==typeof StopIteration){try{result=generator[verb](arg)}catch(exception){return reject(exception)}return result.done?result.value:when(result.value,callback,errback)}try{result=generator[verb](arg)}catch(exception){return isStopIteration(exception)?exception.value:reject(exception)}return when(result,callback,errback)}var generator=makeGenerator.apply(this,arguments),callback=continuer.bind(continuer,"next"),errback=continuer.bind(continuer,"throw");return callback()}}function spawn(makeGenerator){Q.done(Q.async(makeGenerator)())}function _return(value){throw new QReturnValue(value)}function promised(callback){return function(){return spread([this,all(arguments)],function(self,args){return callback.apply(self,args)})}}function dispatch(object,op,args){return Q(object).dispatch(op,args)}function all(promises){return when(promises,function(promises){var countDown=0,deferred=defer();return array_reduce(promises,function(undefined,promise,index){var snapshot;isPromise(promise)&&"fulfilled"===(snapshot=promise.inspect()).state?promises[index]=snapshot.value:(++countDown,when(promise,function(value){promises[index]=value,0===--countDown&&deferred.resolve(promises)},deferred.reject,function(progress){deferred.notify({index:index,value:progress})}))},void 0),0===countDown&&deferred.resolve(promises),deferred.promise})}function allResolved(promises){return when(promises,function(promises){return promises=array_map(promises,Q),when(all(array_map(promises,function(promise){return when(promise,noop,noop)})),function(){return promises})})}function allSettled(promises){return Q(promises).allSettled()}function progress(object,progressed){return Q(object).then(void 0,void 0,progressed)}function nodeify(object,nodeback){return Q(object).nodeify(nodeback)}var hasStacks=!1;try{throw new Error}catch(e){hasStacks=!!e.stack}var qFileName,QReturnValue,qStartingLine=captureLine(),noop=function(){},nextTick=function(){function flush(){for(;head.next;){head=head.next;var task=head.task;head.task=void 0;var domain=head.domain;domain&&(head.domain=void 0,domain.enter());try{task()}catch(e){if(isNodeJS)throw domain&&domain.exit(),setTimeout(flush,0),domain&&domain.enter(),e;setTimeout(function(){throw e},0)}domain&&domain.exit()}flushing=!1}var head={task:void 0,next:null},tail=head,flushing=!1,requestTick=void 0,isNodeJS=!1;if(nextTick=function(task){tail=tail.next={task:task,domain:isNodeJS&&process.domain,next:null},flushing||(flushing=!0,requestTick())},"undefined"!=typeof process&&process.nextTick)isNodeJS=!0,requestTick=function(){process.nextTick(flush)};else if("function"==typeof setImmediate)requestTick="undefined"!=typeof window?setImmediate.bind(window,flush):function(){setImmediate(flush)};else if("undefined"!=typeof MessageChannel){var channel=new MessageChannel;channel.port1.onmessage=function(){requestTick=requestPortTick,channel.port1.onmessage=flush,flush()};var requestPortTick=function(){channel.port2.postMessage(0)};requestTick=function(){setTimeout(flush,0),requestPortTick()}}else requestTick=function(){setTimeout(flush,0)};return nextTick}(),call=Function.call,array_slice=uncurryThis(Array.prototype.slice),array_reduce=uncurryThis(Array.prototype.reduce||function(callback,basis){var index=0,length=this.length;if(1===arguments.length)for(;;){if(index in this){basis=this[index++];break}if(++index>=length)throw new TypeError}for(;length>index;index++)index in this&&(basis=callback(basis,this[index],index));return basis}),array_indexOf=uncurryThis(Array.prototype.indexOf||function(value){for(var i=0;i<this.length;i++)if(this[i]===value)return i;return-1}),array_map=uncurryThis(Array.prototype.map||function(callback,thisp){var self=this,collect=[];return array_reduce(self,function(undefined,value,index){collect.push(callback.call(thisp,value,index,self))},void 0),collect}),object_create=Object.create||function(prototype){function Type(){}return Type.prototype=prototype,new Type},object_hasOwnProperty=uncurryThis(Object.prototype.hasOwnProperty),object_keys=Object.keys||function(object){var keys=[];for(var key in object)object_hasOwnProperty(object,key)&&keys.push(key);return keys},object_toString=uncurryThis(Object.prototype.toString);QReturnValue="undefined"!=typeof ReturnValue?ReturnValue:function(value){this.value=value};var STACK_JUMP_SEPARATOR="From previous event:";Q.resolve=Q,Q.nextTick=nextTick,Q.longStackSupport=!1,Q.defer=defer,defer.prototype.makeNodeResolver=function(){var self=this;return function(error,value){error?self.reject(error):self.resolve(arguments.length>2?array_slice(arguments,1):value)}},Q.Promise=promise,Q.promise=promise,promise.race=race,promise.all=all,promise.reject=reject,promise.resolve=Q,Q.passByCopy=function(object){return object},Promise.prototype.passByCopy=function(){return this},Q.join=function(x,y){return Q(x).join(y)},Promise.prototype.join=function(that){return Q([this,that]).spread(function(x,y){if(x===y)return x;throw new Error("Can't join: not the same: "+x+" "+y)})},Q.race=race,Promise.prototype.race=function(){return this.then(Q.race)},Q.makePromise=Promise,Promise.prototype.toString=function(){return"[object Promise]"},Promise.prototype.then=function(fulfilled,rejected,progressed){function _fulfilled(value){try{return"function"==typeof fulfilled?fulfilled(value):value}catch(exception){return reject(exception)}}function _rejected(exception){if("function"==typeof rejected){makeStackTraceLong(exception,self);try{return rejected(exception)}catch(newException){return reject(newException)}}return reject(exception)}function _progressed(value){return"function"==typeof progressed?progressed(value):value}var self=this,deferred=defer(),done=!1;return nextTick(function(){self.promiseDispatch(function(value){done||(done=!0,deferred.resolve(_fulfilled(value)))},"when",[function(exception){done||(done=!0,deferred.resolve(_rejected(exception)))}])}),self.promiseDispatch(void 0,"when",[void 0,function(value){var newValue,threw=!1;try{newValue=_progressed(value)}catch(e){if(threw=!0,!Q.onerror)throw e;Q.onerror(e)}threw||deferred.notify(newValue)}]),deferred.promise},Q.when=when,Promise.prototype.thenResolve=function(value){return this.then(function(){return value})},Q.thenResolve=function(promise,value){return Q(promise).thenResolve(value)},Promise.prototype.thenReject=function(reason){return this.then(function(){throw reason})},Q.thenReject=function(promise,reason){return Q(promise).thenReject(reason)},Q.nearer=nearer,Q.isPromise=isPromise,Q.isPromiseAlike=isPromiseAlike,Q.isPending=isPending,Promise.prototype.isPending=function(){return"pending"===this.inspect().state},Q.isFulfilled=isFulfilled,Promise.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},Q.isRejected=isRejected,Promise.prototype.isRejected=function(){return"rejected"===this.inspect().state};var unhandledReasons=[],unhandledRejections=[],trackUnhandledRejections=!0;Q.resetUnhandledRejections=resetUnhandledRejections,Q.getUnhandledReasons=function(){return unhandledReasons.slice()},Q.stopUnhandledRejectionTracking=function(){resetUnhandledRejections(),trackUnhandledRejections=!1},resetUnhandledRejections(),Q.reject=reject,Q.fulfill=fulfill,Q.master=master,Q.spread=spread,Promise.prototype.spread=function(fulfilled,rejected){return this.all().then(function(array){return fulfilled.apply(void 0,array)},rejected)},Q.async=async,Q.spawn=spawn,Q["return"]=_return,Q.promised=promised,Q.dispatch=dispatch,Promise.prototype.dispatch=function(op,args){var self=this,deferred=defer();return nextTick(function(){self.promiseDispatch(deferred.resolve,op,args)}),deferred.promise},Q.get=function(object,key){return Q(object).dispatch("get",[key])},Promise.prototype.get=function(key){return this.dispatch("get",[key])},Q.set=function(object,key,value){return Q(object).dispatch("set",[key,value])},Promise.prototype.set=function(key,value){return this.dispatch("set",[key,value])},Q.del=Q["delete"]=function(object,key){return Q(object).dispatch("delete",[key])},Promise.prototype.del=Promise.prototype["delete"]=function(key){return this.dispatch("delete",[key])},Q.mapply=Q.post=function(object,name,args){return Q(object).dispatch("post",[name,args])},Promise.prototype.mapply=Promise.prototype.post=function(name,args){return this.dispatch("post",[name,args])},Q.send=Q.mcall=Q.invoke=function(object,name){return Q(object).dispatch("post",[name,array_slice(arguments,2)])},Promise.prototype.send=Promise.prototype.mcall=Promise.prototype.invoke=function(name){return this.dispatch("post",[name,array_slice(arguments,1)])},Q.fapply=function(object,args){return Q(object).dispatch("apply",[void 0,args])},Promise.prototype.fapply=function(args){return this.dispatch("apply",[void 0,args])},Q["try"]=Q.fcall=function(object){return Q(object).dispatch("apply",[void 0,array_slice(arguments,1)])},Promise.prototype.fcall=function(){return this.dispatch("apply",[void 0,array_slice(arguments)])},Q.fbind=function(object){var promise=Q(object),args=array_slice(arguments,1);return function(){return promise.dispatch("apply",[this,args.concat(array_slice(arguments))])}},Promise.prototype.fbind=function(){var promise=this,args=array_slice(arguments);return function(){return promise.dispatch("apply",[this,args.concat(array_slice(arguments))])}},Q.keys=function(object){return Q(object).dispatch("keys",[])},Promise.prototype.keys=function(){return this.dispatch("keys",[])},Q.all=all,Promise.prototype.all=function(){return all(this)},Q.allResolved=deprecate(allResolved,"allResolved","allSettled"),Promise.prototype.allResolved=function(){return allResolved(this)},Q.allSettled=allSettled,Promise.prototype.allSettled=function(){return this.then(function(promises){return all(array_map(promises,function(promise){function regardless(){return promise.inspect()}return promise=Q(promise),promise.then(regardless,regardless)}))})},Q.fail=Q["catch"]=function(object,rejected){return Q(object).then(void 0,rejected)},Promise.prototype.fail=Promise.prototype["catch"]=function(rejected){return this.then(void 0,rejected)},Q.progress=progress,Promise.prototype.progress=function(progressed){return this.then(void 0,void 0,progressed)},Q.fin=Q["finally"]=function(object,callback){return Q(object)["finally"](callback)},Promise.prototype.fin=Promise.prototype["finally"]=function(callback){return callback=Q(callback),this.then(function(value){return callback.fcall().then(function(){return value})},function(reason){return callback.fcall().then(function(){throw reason})})},Q.done=function(object,fulfilled,rejected,progress){return Q(object).done(fulfilled,rejected,progress)},Promise.prototype.done=function(fulfilled,rejected,progress){var onUnhandledError=function(error){nextTick(function(){if(makeStackTraceLong(error,promise),!Q.onerror)throw error;Q.onerror(error)})},promise=fulfilled||rejected||progress?this.then(fulfilled,rejected,progress):this;"object"==typeof process&&process&&process.domain&&(onUnhandledError=process.domain.bind(onUnhandledError)),promise.then(void 0,onUnhandledError)},Q.timeout=function(object,ms,message){return Q(object).timeout(ms,message)},Promise.prototype.timeout=function(ms,message){var deferred=defer(),timeoutId=setTimeout(function(){deferred.reject(new Error(message||"Timed out after "+ms+" ms"))},ms);return this.then(function(value){clearTimeout(timeoutId),deferred.resolve(value)},function(exception){clearTimeout(timeoutId),deferred.reject(exception)},deferred.notify),deferred.promise},Q.delay=function(object,timeout){return void 0===timeout&&(timeout=object,object=void 0),Q(object).delay(timeout)},Promise.prototype.delay=function(timeout){return this.then(function(value){var deferred=defer();return setTimeout(function(){deferred.resolve(value)},timeout),deferred.promise})},Q.nfapply=function(callback,args){return Q(callback).nfapply(args)},Promise.prototype.nfapply=function(args){var deferred=defer(),nodeArgs=array_slice(args);return nodeArgs.push(deferred.makeNodeResolver()),this.fapply(nodeArgs).fail(deferred.reject),deferred.promise},Q.nfcall=function(callback){var args=array_slice(arguments,1);return Q(callback).nfapply(args)},Promise.prototype.nfcall=function(){var nodeArgs=array_slice(arguments),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),this.fapply(nodeArgs).fail(deferred.reject),deferred.promise},Q.nfbind=Q.denodeify=function(callback){var baseArgs=array_slice(arguments,1);return function(){var nodeArgs=baseArgs.concat(array_slice(arguments)),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),Q(callback).fapply(nodeArgs).fail(deferred.reject),deferred.promise}},Promise.prototype.nfbind=Promise.prototype.denodeify=function(){var args=array_slice(arguments);return args.unshift(this),Q.denodeify.apply(void 0,args)},Q.nbind=function(callback,thisp){var baseArgs=array_slice(arguments,2);return function(){function bound(){return callback.apply(thisp,arguments)}var nodeArgs=baseArgs.concat(array_slice(arguments)),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),Q(bound).fapply(nodeArgs).fail(deferred.reject),deferred.promise}},Promise.prototype.nbind=function(){var args=array_slice(arguments,0);return args.unshift(this),Q.nbind.apply(void 0,args)},Q.nmapply=Q.npost=function(object,name,args){return Q(object).npost(name,args)},Promise.prototype.nmapply=Promise.prototype.npost=function(name,args){var nodeArgs=array_slice(args||[]),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),this.dispatch("post",[name,nodeArgs]).fail(deferred.reject),deferred.promise},Q.nsend=Q.nmcall=Q.ninvoke=function(object,name){var nodeArgs=array_slice(arguments,2),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),Q(object).dispatch("post",[name,nodeArgs]).fail(deferred.reject),deferred.promise},Promise.prototype.nsend=Promise.prototype.nmcall=Promise.prototype.ninvoke=function(name){var nodeArgs=array_slice(arguments,1),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),this.dispatch("post",[name,nodeArgs]).fail(deferred.reject),deferred.promise},Q.nodeify=nodeify,Promise.prototype.nodeify=function(nodeback){return nodeback?void this.then(function(value){nextTick(function(){nodeback(null,value)})},function(error){nextTick(function(){nodeback(error)})}):this};var qEndingLine=captureLine();return Q})}).call(this,require("_process"))},{_process:8}],48:[function(require,module,exports){!function(definition){"object"==typeof exports?module.exports=definition(require("q")):window.Qimage=definition(window.Q)}(function(Q){var Qimage=function(url,options){if(options=options||{},!Qimage.Image)throw new Error("You must define Qimage.Image if not in window context.");var img=new Qimage.Image;options.crossOrigin&&(img.crossOrigin=options.crossOrigin);var d=Q.defer();return img.onload=function(){d.resolve(img)},img.onabort=function(e){d.reject(e)},img.onerror=function(e){d.reject(e)},img.src=url,d.promise};return"undefined"!=typeof window&&(Qimage.Image=window.Image),Qimage.anonymously=function(url){return Qimage(url,{crossOrigin:"Anonymous"})},Qimage})},{q:47}],49:[function(require,module){var Q=require("q"),requestAnimationFrame=require("raf"),now=require("performance-now");module.exports=function(canvas){function draw(from,to,p){canvas.width=canvas.width,ctx.drawImage(from,0,0,canvas.width,canvas.height),ctx.globalAlpha=p,ctx.drawImage(to,0,0,canvas.width,canvas.height)}var ctx=canvas.getContext("2d"),animationDefer=null;return function(from,to,duration,easing){var start=now(),d=Q.defer();return animationDefer=d,function render(){if(animationDefer===d){var p=Math.min((now()-start)/duration,1);1>p?requestAnimationFrame(render):(d.resolve(canvas),animationDefer=null),draw(from,to,easing(p))}}(),d.promise}}},{"performance-now":74,q:47,raf:75}],50:[function(require,module){var Q=require("q"),Zanimo=require("zanimo");module.exports=function(container){function addImage(img){var old={position:img.style.position,top:img.style.top,left:img.style.left,opacity:img.style.opacity};return img.style.position="absolute",img.style.top="0",img.style.left="0",container.appendChild(img),old}function removeImage(img,restore){for(var k in restore)img.style[k]=restore[k];container.removeChild(img)}return"absolute"!==container.style.position&&(container.style.position="relative"),container.style.overflow="hidden",container.style.backgroundColor="#000",container.innerHTML="",function(from,to,duration,easing){var previousFrom=addImage(from),previousTo=addImage(to),cssEasing=easing&&("string"==typeof easing?easing:easing.toCSS&&easing.toCSS())||"linear",p=Q.all([Zanimo(from,"opacity",1),Zanimo(to,"opacity",0)]).then(function(){return Q.all([Zanimo(from,"opacity",0,duration,cssEasing),Zanimo(to,"opacity",1,duration,cssEasing)])});return p.done(function(){removeImage(from,previousFrom),removeImage(to,previousTo)}),p}}},{q:47,zanimo:85}],51:[function(require,module){var GlslTransition=require("glsl-transition");module.exports=function(canvas){var fade=GlslTransition(canvas)("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 resolution;uniform sampler2D from, to;uniform float progress;void main() {vec2 p = gl_FragCoord.xy / resolution;gl_FragColor = mix(texture2D(from, p), texture2D(to, p), progress);}");return function(from,to,duration,easing){return fade({from:from,to:to},duration,easing)}}},{"glsl-transition":73}],52:[function(require,module){function linear(x){return x}function wrap(constructor){return function(elt){var t=constructor(elt);return function(from,to,duration,easing){return t(from,to,duration,easing||linear)}}}var fadeCanvas2D=require("./fade-canvas2d"),fadeWebGL=require("./fade-webgl"),fadeDOM=require("./fade-dom"),Module=module.exports={DOM:wrap(fadeDOM),Canvas2D:wrap(fadeCanvas2D),WebGL:wrap(fadeWebGL),Canvas:function(canvas){return window.WebGLRenderingContext?Module.WebGL(canvas):Module.Canvas2D(canvas)}}},{"./fade-canvas2d":49,"./fade-dom":50,"./fade-webgl":51}],53:[function(require,module){"use strict";function ShaderAttribute(gl,program,location,dimension,name,constFunc,relink){this._gl=gl,this._program=program,this._location=location,this._dimension=dimension,this._name=name,this._constFunc=constFunc,this._relink=relink}function addVectorAttribute(gl,program,location,dimension,obj,name,doLink){for(var constFuncArgs=["gl","v"],varNames=[],i=0;dimension>i;++i)constFuncArgs.push("x"+i),varNames.push("x"+i);constFuncArgs.push(["if(x0.length===undefined){return gl.vertexAttrib",dimension,"f(v,",varNames.join(","),")}else{return gl.vertexAttrib",dimension,"fv(v,x0)}"].join(""));var constFunc=Function.apply(void 0,constFuncArgs),attr=new ShaderAttribute(gl,program,location,dimension,name,constFunc,doLink);Object.defineProperty(obj,name,{set:function(x){return gl.disableVertexAttribArray(attr._location),constFunc(gl,attr._location,x),x},get:function(){return attr},enumerable:!0})}function createAttributeWrapper(gl,program,attributes,doLink){for(var obj={},i=0,n=attributes.length;n>i;++i){var a=attributes[i],name=a.name,type=a.type,location=gl.getAttribLocation(program,name);switch(type){case"bool":case"int":case"float":addVectorAttribute(gl,program,location,1,obj,name,doLink);break;default:if(!(type.indexOf("vec")>=0))throw new Error("Unknown data type for attribute "+name+": "+type);var d=type.charCodeAt(type.length-1)-48;if(2>d||d>4)throw new Error("Invalid data type for attribute "+name+": "+type);addVectorAttribute(gl,program,location,d,obj,name,doLink)}}return obj}module.exports=createAttributeWrapper;var proto=ShaderAttribute.prototype;proto.pointer=function(type,normalized,stride,offset){var gl=this._gl;gl.vertexAttribPointer(this._location,this._dimension,type||gl.FLOAT,normalized?gl.TRUE:gl.FALSE,stride||0,offset||0),this._gl.enableVertexAttribArray(this._location)},Object.defineProperty(proto,"location",{get:function(){return this._location},set:function(v){v!==this._location&&(this._location=v,this._gl.bindAttribLocation(this._program,v,this._name),this._gl.linkProgram(this._program),this._relink())}})},{}],54:[function(require,module){"use strict";function identity(x){var c=new Function("y","return function(){return y}");return c(x)}function createUniformWrapper(gl,program,uniforms,locations){function makeGetter(index){var proc=new Function("gl","prog","locations","return function(){return gl.getUniform(prog,locations["+index+"])}");return proc(gl,program,locations)}function makePropSetter(path,index,type){switch(type){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+index+"],obj"+path+")";case"float":return"gl.uniform1f(locations["+index+"],obj"+path+")";default:var vidx=type.indexOf("vec");if(!(vidx>=0&&1>=vidx&&type.length===4+vidx)){if(0===type.indexOf("mat")&&4===type.length){var d=type.charCodeAt(type.length-1)-48;if(2>d||d>4)throw new Error("Invalid uniform dimension type for matrix "+name+": "+type);return"gl.uniformMatrix"+d+"fv(locations["+index+"],false,obj"+path+")"}throw new Error("Unknown uniform data type for "+name+": "+type)}var d=type.charCodeAt(type.length-1)-48;if(2>d||d>4)throw new Error("Invalid data type");switch(type.charAt(0)){case"b":case"i":return"gl.uniform"+d+"iv(locations["+index+"],obj"+path+")";case"v":return"gl.uniform"+d+"fv(locations["+index+"],obj"+path+")";default:throw new Error("Unrecognized data type for vector "+name+": "+type)}}}function enumerateIndices(prefix,type){if("object"!=typeof type)return[[prefix,type]];var indices=[];for(var id in type){var prop=type[id],tprefix=prefix;tprefix+=parseInt(id)+""===id?"["+id+"]":"."+id,"object"==typeof prop?indices.push.apply(indices,enumerateIndices(tprefix,prop)):indices.push([tprefix,prop])}return indices}function makeSetter(type){for(var code=["return function updateProperty(obj){"],indices=enumerateIndices("",type),i=0;i<indices.length;++i){var item=indices[i],path=item[0],idx=item[1];locations[idx]&&code.push(makePropSetter(path,idx,uniforms[idx].type))}code.push("return obj}");var proc=new Function("gl","prog","locations",code.join("\n"));return proc(gl,program,locations)}function defaultValue(type){switch(type){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var vidx=type.indexOf("vec");if(vidx>=0&&1>=vidx&&type.length===4+vidx){var d=type.charCodeAt(type.length-1)-48;if(2>d||d>4)throw new Error("Invalid data type");return"b"===type.charAt(0)?dup(d,!1):dup(d)}if(0===type.indexOf("mat")&&4===type.length){var d=type.charCodeAt(type.length-1)-48;if(2>d||d>4)throw new Error("Invalid uniform dimension type for matrix "+name+": "+type);return dup([d,d])}throw new Error("Unknown uniform data type for "+name+": "+type)}}function storeProperty(obj,prop,type){if("object"==typeof type){var child=processObject(type);Object.defineProperty(obj,prop,{get:identity(child),set:makeSetter(type),enumerable:!0,configurable:!1})}else locations[type]?Object.defineProperty(obj,prop,{get:makeGetter(type),set:makeSetter(type),enumerable:!0,configurable:!1}):obj[prop]=defaultValue(uniforms[type].type)}function processObject(obj){var result;if(Array.isArray(obj)){result=new Array(obj.length);for(var i=0;i<obj.length;++i)storeProperty(result,i,obj[i])}else{result={};for(var id in obj)storeProperty(result,id,obj[id])}return result}var coallesced=coallesceUniforms(uniforms,!0);return{get:identity(processObject(coallesced)),set:makeSetter(coallesced),enumerable:!0,configurable:!0}}var dup=require("dup"),coallesceUniforms=require("./reflect.js");module.exports=createUniformWrapper},{"./reflect.js":55,dup:56}],55:[function(require,module){"use strict";function makeReflectTypes(uniforms,useIndex){for(var obj={},i=0;i<uniforms.length;++i)for(var n=uniforms[i].name,parts=n.split("."),o=obj,j=0;j<parts.length;++j){var x=parts[j].split("[");if(x.length>1){x[0]in o||(o[x[0]]=[]),o=o[x[0]];for(var k=1;k<x.length;++k){var y=parseInt(x[k]);k<x.length-1||j<parts.length-1?(y in o||(o[y]=k<x.length-1?[]:{}),o=o[y]):o[y]=useIndex?i:uniforms[i].type}}else j<parts.length-1?(x[0]in o||(o[x[0]]={}),o=o[x[0]]):o[x[0]]=useIndex?i:uniforms[i].type}return obj}module.exports=makeReflectTypes},{}],56:[function(require,module){"use strict";function dupe_array(count,value,i){var c=0|count[i];if(0>=c)return[];var j,result=new Array(c);if(i===count.length-1)for(j=0;c>j;++j)result[j]=value;else for(j=0;c>j;++j)result[j]=dupe_array(count,value,i+1);return result}function dupe_number(count,value){var result,i;for(result=new Array(count),i=0;count>i;++i)result[i]=value;return result}function dupe(count,value){switch("undefined"==typeof value&&(value=0),typeof count){case"number":if(count>0)return dupe_number(0|count,value);break;case"object":if("number"==typeof count.length)return dupe_array(count,value,0)}return[]}module.exports=dupe},{}],57:[function(require,module){"use strict";function Shader(gl,prog,vertShader,fragShader){this.gl=gl,this.handle=prog,this.attributes=null,this.uniforms=null,this.types=null,this.vertexShader=vertShader,this.fragmentShader=fragShader}function relinkUniforms(gl,program,locations,uniforms){for(var i=0;i<uniforms.length;++i)locations[i]=gl.getUniformLocation(program,uniforms[i].name)}function createShader(gl,vertSource,fragSource,uniforms,attributes){var vertShader=gl.createShader(gl.VERTEX_SHADER);if(gl.shaderSource(vertShader,vertSource),gl.compileShader(vertShader),!gl.getShaderParameter(vertShader,gl.COMPILE_STATUS))throw new Error("Error compiling vertex shader: "+gl.getShaderInfoLog(vertShader));var fragShader=gl.createShader(gl.FRAGMENT_SHADER);if(gl.shaderSource(fragShader,fragSource),gl.compileShader(fragShader),!gl.getShaderParameter(fragShader,gl.COMPILE_STATUS))throw new Error("Error compiling fragment shader: "+gl.getShaderInfoLog(fragShader));var program=gl.createProgram();if(gl.attachShader(program,fragShader),gl.attachShader(program,vertShader),gl.linkProgram(program),!gl.getProgramParameter(program,gl.LINK_STATUS))throw new Error("Error linking shader program: "+gl.getProgramInfoLog(program));var shader=new Shader(gl,program,vertShader,fragShader);return shader.updateExports(uniforms,attributes),shader}var createUniformWrapper=require("./lib/create-uniforms.js"),createAttributeWrapper=require("./lib/create-attributes.js"),makeReflect=require("./lib/reflect.js");Shader.prototype.bind=function(){this.gl.useProgram(this.handle)},Shader.prototype.dispose=function(){var gl=this.gl;gl.deleteShader(this.vertexShader),gl.deleteShader(this.fragmentShader),gl.deleteProgram(this.handle)},Shader.prototype.updateExports=function(uniforms,attributes){var locations=new Array(uniforms.length),program=this.handle,gl=this.gl,doLink=relinkUniforms.bind(void 0,gl,program,locations,uniforms);doLink(),this.types={uniforms:makeReflect(uniforms),attributes:makeReflect(attributes)},this.attributes=createAttributeWrapper(gl,program,attributes,doLink),Object.defineProperty(this,"uniforms",createUniformWrapper(gl,program,uniforms,locations))},module.exports=createShader},{"./lib/create-attributes.js":53,"./lib/create-uniforms.js":54,"./lib/reflect.js":55}],58:[function(require,module){"use strict";function parseDeclaration(x){for(var type,i,identifiers=[],i=0;i<x.children.length;++i){var c=x.children[i];if("placeholder"!==c.type)if("keyword"===c.type){if("uniform"===c.token.data||"attribute"===c.token.data)continue;type=c.token.data}else if("decllist"===c.type)for(var j=0;j<c.children.length;++j){var d=c.children[j];"ident"===d.type&&identifiers.push(d.token.data)
}}return{type:type,vars:identifiers}}function glslGlobals(src){var uniforms={},attributes={},strm=through();return strm.pipe(glslTokenizer()).pipe(glslParser()).on("data",function(x){if("decl"===x.type&&"keyword"===x.token.type)if("uniform"===x.token.data)for(var result=parseDeclaration(x),i=0;i<result.vars.length;++i)uniforms[result.vars[i]]=result.type;else if("attribute"===x.token.data)for(var result=parseDeclaration(x),i=0;i<result.vars.length;++i)attributes[result.vars[i]]=result.type}),strm.write(src),{uniforms:uniforms,attributes:attributes}}var glslTokenizer=require("glsl-tokenizer"),glslParser=require("glsl-parser"),through=require("through");module.exports=glslGlobals},{"glsl-parser":59,"glsl-tokenizer":64,through:68}],59:[function(require,module){module.exports=require("./lib/index")},{"./lib/index":61}],60:[function(require,module){function itself(){return this}function symbol(id,binding_power){var sym=symbol_table[id];return binding_power=binding_power||0,sym?binding_power>sym.lbp&&(sym.lbp=binding_power):(sym=Object.create(original_symbol),sym.id=id,sym.lbp=binding_power,symbol_table[id]=sym),sym}function expression(rbp){var left,t=token;for(advance(),left=t.nud();rbp<token.lbp;)t=token,advance(),left=t.led(left);return left}function infix(id,bp,led){var sym=symbol(id,bp);sym.led=led||function(left){return this.children=[left,expression(bp)],this.type="binary",this}}function infixr(id,bp,led){var sym=symbol(id,bp);return sym.led=led||function(left){return this.children=[left,expression(bp-1)],this.type="binary",this},sym}function prefix(id,nud){var sym=symbol(id);return sym.nud=nud||function(){return this.children=[expression(70)],this.type="unary",this},sym}function suffix(id){var sym=symbol(id,150);sym.led=function(left){return this.children=[left],this.type="suffix",this}}function assignment(id){return infixr(id,10,function(left){return this.children=[left,expression(9)],this.assignment=!0,this.type="assign",this})}function advance(id){var next,value,type,output;if(id&&token.data!==id)return state.unexpected("expected `"+id+"`, got `"+token.data+"`");if(idx>=tokens.length)return void(token=symbol_table["(end)"]);if(next=tokens[idx++],value=next.data,type=next.type,"ident"===type)output=state.scope.find(value)||state.create_node(),type=output.type;else if("builtin"===type)output=symbol_table["(builtin)"];else if("keyword"===type)output=symbol_table["(keyword)"];else if("operator"===type){if(output=symbol_table[value],!output)return state.unexpected("unknown operator `"+value+"`")}else{if("float"!==type&&"integer"!==type)return state.unexpected("unexpected token.");type="literal",output=symbol_table["(literal)"]}return output&&(output.nud||(output.nud=itself),output.children||(output.children=[])),output=Object.create(output),output.token=next,output.type=type,output.data||(output.data=value),token=output}function fail(message){return function(){return state.unexpected(message)}}var state,token,tokens,idx,original_symbol={nud:function(){return this.children&&this.children.length?this:fail("unexpected")()},led:fail("missing operator")},symbol_table={};symbol("(ident)").nud=itself,symbol("(keyword)").nud=itself,symbol("(builtin)").nud=itself,symbol("(literal)").nud=itself,symbol("(end)"),symbol(":"),symbol(";"),symbol(","),symbol(")"),symbol("]"),symbol("}"),infixr("&&",30),infixr("||",30),infix("|",43),infix("^",44),infix("&",45),infix("==",46),infix("!=",46),infix("<",47),infix("<=",47),infix(">",47),infix(">=",47),infix(">>",48),infix("<<",48),infix("+",50),infix("-",50),infix("*",60),infix("/",60),infix("%",60),infix("?",20,function(left){return this.children=[left,expression(0),(advance(":"),expression(0))],this.type="ternary",this}),infix(".",80,function(left){return token.type="literal",state.fake(token),this.children=[left,token],advance(),this}),infix("[",80,function(left){return this.children=[left,expression(0)],this.type="binary",advance("]"),this}),infix("(",80,function(left){if(this.children=[left],this.type="call",")"!==token.data)for(;;){if(this.children.push(expression(0)),","!==token.data)break;advance(",")}return advance(")"),this}),prefix("-"),prefix("+"),prefix("!"),prefix("~"),prefix("defined"),prefix("(",function(){return this.type="group",this.children=[expression(0)],advance(")"),this}),prefix("++"),prefix("--"),suffix("++"),suffix("--"),assignment("="),assignment("+="),assignment("-="),assignment("*="),assignment("/="),assignment("%="),assignment("&="),assignment("|="),assignment("^="),assignment(">>="),assignment("<<="),module.exports=function(incoming_state,incoming_tokens){function emit(node){state.unshift(node,!1);for(var i=0,len=node.children.length;len>i;++i)emit(node.children[i]);state.shift()}state=incoming_state,tokens=incoming_tokens,idx=0;var result;if(tokens.length){if(advance(),result=expression(0),result.parent=state[0],emit(result),idx<tokens.length)throw new Error("did not use all tokens");result.parent.children=[result]}}},{}],61:[function(require,module){function parser(){function write(input){if("whitespace"===input.type||"line-comment"===input.type||"block-comment"===input.type)return void whitespace.push(input);for(tokens.push(input),token=token||tokens[0],token&&whitespace.length&&(token.preceding=token.preceding||[],token.preceding=token.preceding.concat(whitespace),whitespace=[]);take();)switch(state[0].mode){case STMT:parse_stmt();break;case STMTLIST:parse_stmtlist();break;case DECL:parse_decl();break;case DECLLIST:parse_decllist();break;case EXPR:parse_expr();break;case STRUCT:parse_struct(!0,!0);break;case PRECISION:parse_precision();break;case IDENT:parse_ident();break;case KEYWORD:parse_keyword();break;case KEYWORD_OR_IDENT:parse_keyword_or_ident();break;case FUNCTION:parse_function();break;case FUNCTIONARGS:parse_function_args();break;case FORLOOP:parse_forloop();break;case WHILELOOP:parse_whileloop();break;case DOWHILELOOP:parse_dowhileloop();break;case RETURN:parse_return();break;case IF:parse_if();break;case QUANTIFIER:parse_quantifier()}}function end(tokens){return arguments.length&&write(tokens),state.length>1?void unexpected("unexpected EOF"):void stream.emit("end")}function take(){return errored||!state.length?!1:(token=tokens[0])&&!stream.paused}function special_fake(x){state.unshift(x),state.shift()}function special_unshift(_node,add_child){_node.parent=state[0];var ret=[].unshift.call(this,_node);if(add_child=void 0===add_child?!0:add_child,DEBUG){for(var pad="",i=0,len=this.length-1;len>i;++i)pad+=" |";console.log(pad,"\\"+_node.type,_node.token.data)}return add_child&&node!==_node&&node.children.push(_node),node=_node,ret}function special_shift(){var _node=[].shift.call(this),okay=check[this.length],emit=!1;if(DEBUG){for(var pad="",i=0,len=this.length;len>i;++i)pad+=" |";console.log(pad,"/"+_node.type)}return check.length?"function"==typeof check[0]?emit=check[0](_node):void 0!==okay&&(emit=okay.test?okay.test(_node.type):okay===_node.type):emit=!0,emit&&stream.emit("data",_node),node=_node.parent,_node}function parse_stmtlist(){function normal_mode(){if(token.data===state[0].expecting)return state.scope.exit(),state.shift();switch(token.type){case"preprocessor":return state.fake(adhoc()),void tokens.shift();default:return void state.unshift(stmt())}}return stative(function(){return state.scope.enter(),Advance},normal_mode)()}function parse_stmt(){if(state[0].brace)return"}"!==token.data?unexpected("expected `}`, got "+token.data):(state[0].brace=!1,tokens.shift(),state.shift());switch(token.type){case"eof":return state.shift();case"keyword":switch(token.data){case"for":return state.unshift(forstmt());case"if":return state.unshift(ifstmt());case"while":return state.unshift(whilestmt());case"do":return state.unshift(dowhilestmt());case"break":return state.fake(mknode(BREAK,token)),tokens.shift();case"continue":return state.fake(mknode(CONTINUE,token)),tokens.shift();case"discard":return state.fake(mknode(DISCARD,token)),tokens.shift();case"return":return state.unshift(returnstmt());case"precision":return state.unshift(precision())}return state.unshift(decl(DECL_STATEMENT));case"ident":var lookup;if(lookup=state.scope.find(token.data))return state.unshift("struct"===lookup.parent.type?decl(DECL_STATEMENT):expr(";"));case"operator":if("{"===token.data){state[0].brace=!0;var n=stmtlist();return n.expecting="}",tokens.shift(),state.unshift(n)}if(";"===token.data)return tokens.shift(),state.shift();default:return state.unshift(expr(";"))}}function parse_decl(){function invariant_or_not(){return"invariant"===token.data?stmt.flags&DECL_ALLOW_INVARIANT?(state.unshift(keyword()),Advance):unexpected("`invariant` is not allowed here"):(state.fake(mknode(PLACEHOLDER,{data:"",position:token.position})),Advance)}function storage_or_not(){return is_storage(token)?stmt.flags&DECL_ALLOW_STORAGE?(state.unshift(keyword()),Advance):unexpected("storage is not allowed here"):(state.fake(mknode(PLACEHOLDER,{data:"",position:token.position})),Advance)}function parameter_or_not(){return is_parameter(token)?stmt.flags&DECL_NO_INOUT?unexpected("parameter is not allowed here"):(state.unshift(keyword()),Advance):(state.fake(mknode(PLACEHOLDER,{data:"",position:token.position})),Advance)}function precision_or_not(){return is_precision(token)?(state.unshift(keyword()),Advance):(state.fake(mknode(PLACEHOLDER,{data:"",position:token.position})),Advance)}function struct_or_type(){if("struct"===token.data)return stmt.flags&DECL_ALLOW_STRUCT?(state.unshift(struct()),Advance):unexpected("cannot nest structs");if("keyword"===token.type)return state.unshift(keyword()),Advance;var lookup=state.scope.find(token.data);return lookup?(state.fake(Object.create(lookup)),tokens.shift(),Advance):unexpected("expected user defined type, struct or keyword, got "+token.data)}function maybe_name(){return","!==token.data||stmt.flags&DECL_ALLOW_COMMA?"["===token.data?void state.unshift(quantifier()):")"===token.data?state.shift():";"===token.data?stmt.stage+3:"ident"!==token.type&&"builtin"!==token.type?unexpected("expected identifier, got "+token.data):(stmt.collected_name=tokens.shift(),Advance):state.shift()}function maybe_lparen(){return"("===token.data?(tokens.unshift(stmt.collected_name),delete stmt.collected_name,state.unshift(fn()),stmt.stage+2):Advance}function is_decllist(){return tokens.unshift(stmt.collected_name),delete stmt.collected_name,state.unshift(decllist()),Advance}function done(){return state.shift()}var stmt=state[0];return stative(invariant_or_not,storage_or_not,parameter_or_not,precision_or_not,struct_or_type,maybe_name,maybe_lparen,is_decllist,done)()}function parse_decllist(){if("ident"===token.type){var name=token.data;return state.unshift(ident()),void state.scope.define(name)}if("operator"===token.type){if(","===token.data)return state[1].flags&DECL_ALLOW_COMMA?tokens.shift():state.shift();if("="===token.data)return state[1].flags&DECL_ALLOW_ASSIGN?(tokens.shift(),void state.unshift(expr(",",";"))):unexpected("`=` is not allowed here.");if("["===token.data)return void state.unshift(quantifier())}return state.shift()}function parse_keyword_or_ident(){return"keyword"===token.type?(state[0].type="keyword",void(state[0].mode=KEYWORD)):"ident"===token.type?(state[0].type="ident",void(state[0].mode=IDENT)):unexpected("expected keyword or user-defined name, got "+token.data)}function parse_keyword(){return"keyword"!==token.type?unexpected("expected keyword, got "+token.data):(state.shift(),tokens.shift())}function parse_ident(){return"ident"!==token.type?unexpected("expected user-defined name, got "+token.data):(state[0].data=token.data,state.shift(),tokens.shift())}function parse_expr(){function parseexpr(tokens){return full_parse_expr(state,tokens),state.shift()}var expecting=state[0].expecting;if(state[0].tokens=state[0].tokens||[],void 0===state[0].parenlevel&&(state[0].parenlevel=0,state[0].bracelevel=0),state[0].parenlevel<1&&expecting.indexOf(token.data)>-1)return parseexpr(state[0].tokens);switch("("===token.data?++state[0].parenlevel:")"===token.data&&--state[0].parenlevel,token.data){case"{":++state[0].bracelevel;break;case"}":--state[0].bracelevel;break;case"(":++state[0].parenlevel;break;case")":--state[0].parenlevel}return state[0].parenlevel<0?unexpected("unexpected `)`"):state[0].bracelevel<0?unexpected("unexpected `}`"):void state[0].tokens.push(tokens.shift())}function n(type){return function(){return mknode(type,token)}}function adhoc(){return mknode(token_map[token.type],token,node)}function decl(flags){var _=mknode(DECL,token,node);return _.flags=flags,_}function struct(allow_assign,allow_comma){var _=mknode(STRUCT,token,node);return _.allow_assign=void 0===allow_assign?!0:allow_assign,_.allow_comma=void 0===allow_comma?!0:allow_comma,_}function expr(){var n=mknode(EXPR,token,node);return n.expecting=[].slice.call(arguments),n}function keyword(default_value){var t=token;return default_value&&(t={type:"(implied)",data:"(default)",position:t.position}),mknode(KEYWORD,t,node)}function unexpected(str){errored=!0,stream.emit("error",new Error((str||"unexpected "+state)+" at line "+state[0].token.line))}function assert(type,data){return assert_null_string_or_array(type,token.type)&&assert_null_string_or_array(data,token.data)}function assert_null_string_or_array(x,y){switch(typeof x){case"string":return y!==x&&unexpected("expected `"+x+"`, got "+y+"\n"+token.data),!errored;case"object":return x&&-1===x.indexOf(y)&&unexpected("expected one of `"+x.join("`, `")+"`, got "+y),!errored}return!0}function stative(){var step,result,steps=[].slice.call(arguments);return function(){var current=state[0];return current.stage||(current.stage=0),(step=steps[current.stage])?(result=step(),result===Advance?++current.stage:void(void 0!==result&&(current.stage=result))):unexpected("parser in undefined state!")}}function advance(op,t){return t=t||"operator",function(){if(assert(t,op)){var last=tokens.shift(),children=state[0].children,last_node=children[children.length-1];return last_node&&last_node.token&&last.preceding&&(last_node.token.succeeding=last_node.token.succeeding||[],last_node.token.succeeding=last_node.token.succeeding.concat(last.preceding)),Advance}}}function advance_expr(until){return function(){return state.unshift(expr(until)),Advance}}function advance_ident(declare){return declare?function(){var name=token.data;return assert("ident")&&(state.unshift(ident()),state.scope.define(name),Advance)}:function(){if(assert("ident")){var s=Object.create(state.scope.find(token.data));return s.token=token,tokens.shift(),Advance}}}function advance_stmtlist(){return function(){var n=stmtlist();return n.expecting="}",state.unshift(n),Advance}}function maybe_stmtlist(skip){return function(){var current=state[0].stage;return"{"!==token.data?(state.unshift(stmt()),current+skip):(tokens.shift(),Advance)}}function popstmt(){return function(){return state.shift(),state.shift()}}function setup_stative_parsers(){parse_struct=stative(advance("struct","keyword"),function(){return"{"===token.data?(state.fake(mknode(IDENT,{data:"",position:token.position,type:"ident"})),Advance):advance_ident(!0)()},function(){return state.scope.enter(),Advance},advance("{"),function(){return"preprocessor"===token.type?(state.fake(adhoc()),void tokens.shift()):"}"===token.data?(state.scope.exit(),tokens.shift(),state.shift()):";"===token.data?void tokens.shift():void state.unshift(decl(DECL_STRUCT))}),parse_precision=stative(function(){return tokens.shift(),Advance},function(){return assert("keyword",["lowp","mediump","highp"])&&(state.unshift(keyword()),Advance)},function(){return state.unshift(keyword()),Advance},function(){return state.shift()}),parse_quantifier=stative(advance("["),advance_expr("]"),advance("]"),function(){return state.shift()}),parse_forloop=stative(advance("for","keyword"),advance("("),function(){var lookup;if("ident"===token.type){if((lookup=state.scope.find(token.data))||(lookup=state.create_node()),"struct"===lookup.parent.type)return state.unshift(decl(DECL_STATEMENT)),Advance}else if("builtin"===token.type||"keyword"===token.type)return state.unshift(decl(DECL_STATEMENT)),Advance;return advance_expr(";")()},advance(";"),advance_expr(";"),advance(";"),advance_expr(")"),advance(")"),maybe_stmtlist(3),advance_stmtlist(),advance("}"),popstmt()),parse_if=stative(advance("if","keyword"),advance("("),advance_expr(")"),advance(")"),maybe_stmtlist(3),advance_stmtlist(),advance("}"),function(){return"else"===token.data?(tokens.shift(),state.unshift(stmt()),Advance):popstmt()()},popstmt()),parse_return=stative(advance("return","keyword"),function(){return";"===token.data?Advance:(state.unshift(expr(";")),Advance)},function(){tokens.shift(),popstmt()()}),parse_whileloop=stative(advance("while","keyword"),advance("("),advance_expr(")"),advance(")"),maybe_stmtlist(3),advance_stmtlist(),advance("}"),popstmt()),parse_dowhileloop=stative(advance("do","keyword"),maybe_stmtlist(3),advance_stmtlist(),advance("}"),advance("while","keyword"),advance("("),advance_expr(")"),advance(")"),popstmt()),parse_function=stative(function(){for(var i=1,len=state.length;len>i;++i)if(state[i].mode===FUNCTION)return unexpected("function definition is not allowed within another function");return Advance},function(){if(assert("ident")){var name=token.data,lookup=state.scope.find(name);return state.unshift(ident()),state.scope.define(name),state.scope.enter(lookup?lookup.scope:null),Advance}},advance("("),function(){return state.unshift(fnargs()),Advance},advance(")"),function(){return";"===token.data?(state.scope.exit(),state.shift(),state.shift()):Advance},advance("{"),advance_stmtlist(),advance("}"),function(){return state.scope.exit(),Advance},function(){return state.shift(),state.shift(),state.shift()}),parse_function_args=stative(function(){return"void"===token.data?(state.fake(keyword()),tokens.shift(),Advance):")"===token.data?void state.shift():"struct"===token.data?(state.unshift(struct(NO_ASSIGN_ALLOWED,NO_COMMA_ALLOWED)),Advance):(state.unshift(decl(DECL_FUNCTION)),Advance)},function(){return","===token.data?(tokens.shift(),0):")"===token.data?void state.shift():void unexpected("expected one of `,` or `)`, got "+token.data)})}var parse_struct,parse_precision,parse_quantifier,parse_forloop,parse_if,parse_return,parse_whileloop,parse_dowhileloop,parse_function,parse_function_args,program,token,node,stmtlist=n(STMTLIST),stmt=n(STMT),decllist=n(DECLLIST),precision=n(PRECISION),ident=n(IDENT),fn=(n(KEYWORD_OR_IDENT),n(FUNCTION)),fnargs=n(FUNCTIONARGS),forstmt=n(FORLOOP),ifstmt=n(IF),whilestmt=n(WHILELOOP),returnstmt=n(RETURN),dowhilestmt=n(DOWHILELOOP),quantifier=n(QUANTIFIER),stream=through(write,end),check=arguments.length?[].slice.call(arguments):[],state=[],tokens=[],whitespace=[],errored=!1;return state.shift=special_shift,state.unshift=special_unshift,state.fake=special_fake,state.unexpected=unexpected,state.scope=new Scope(state),state.create_node=function(){var n=mknode(IDENT,token);return n.parent=stream.program,n},setup_stative_parsers(),node=stmtlist(),node.expecting="(eof)",node.mode=STMTLIST,node.token={type:"(program)",data:"(program)"},program=node,stream.program=program,stream.scope=function(scope){return 1===arguments.length&&(state.scope=scope),state.scope},state.unshift(node),stream}function mknode(mode,sourcetoken){return{mode:mode,token:sourcetoken,children:[],type:stmt_type[mode],id:(4294967295*Math.random()).toString(16)}}function is_storage(token){return"const"===token.data||"attribute"===token.data||"uniform"===token.data||"varying"===token.data}function is_parameter(token){return"in"===token.data||"inout"===token.data||"out"===token.data}function is_precision(token){return"highp"===token.data||"mediump"===token.data||"lowp"===token.data}module.exports=parser;var through=require("through"),full_parse_expr=require("./expr"),Scope=require("./scope"),Advance=new Object,DEBUG=!1,_=0,IDENT=_++,STMT=_++,STMTLIST=_++,STRUCT=_++,FUNCTION=_++,FUNCTIONARGS=_++,DECL=_++,DECLLIST=_++,FORLOOP=_++,WHILELOOP=_++,IF=_++,EXPR=_++,PRECISION=_++,COMMENT=_++,PREPROCESSOR=_++,KEYWORD=_++,KEYWORD_OR_IDENT=_++,RETURN=_++,BREAK=_++,CONTINUE=_++,DISCARD=_++,DOWHILELOOP=_++,PLACEHOLDER=_++,QUANTIFIER=_++,DECL_ALLOW_ASSIGN=1,DECL_ALLOW_COMMA=2,DECL_REQUIRE_NAME=4,DECL_ALLOW_INVARIANT=8,DECL_ALLOW_STORAGE=16,DECL_NO_INOUT=32,DECL_ALLOW_STRUCT=64,DECL_STATEMENT=255,DECL_FUNCTION=DECL_STATEMENT&~(DECL_ALLOW_ASSIGN|DECL_ALLOW_COMMA|DECL_NO_INOUT|DECL_ALLOW_INVARIANT|DECL_REQUIRE_NAME),DECL_STRUCT=DECL_STATEMENT&~(DECL_ALLOW_ASSIGN|DECL_ALLOW_INVARIANT|DECL_ALLOW_STORAGE|DECL_ALLOW_STRUCT),NO_ASSIGN_ALLOWED=!1,NO_COMMA_ALLOWED=!1,token_map={"block-comment":COMMENT,"line-comment":COMMENT,preprocessor:PREPROCESSOR},stmt_type=_=["ident","stmt","stmtlist","struct","function","functionargs","decl","decllist","forloop","whileloop","if","expr","precision","comment","preprocessor","keyword","keyword_or_ident","return","break","continue","discard","do-while","placeholder","quantifier"]},{"./expr":60,"./scope":62,through:63}],62:[function(require,module){function scope(state){return this.constructor!==scope?new scope(state):(this.state=state,this.scopes=[],void(this.current=null))}module.exports=scope;var cons=scope,proto=cons.prototype;proto.enter=function(s){this.scopes.push(this.current=this.state[0].scope=s||{})},proto.exit=function(){this.scopes.pop(),this.current=this.scopes[this.scopes.length-1]},proto.define=function(str){this.current[str]=this.state[0]},proto.find=function(name){for(var i=this.scopes.length-1;i>-1;--i)if(this.scopes[i].hasOwnProperty(name))return this.scopes[i][name];return null}},{}],63:[function(require,module,exports){(function(process){function through(write,end){function drain(){for(;buffer.length&&!stream.paused;){var data=buffer.shift();if(null===data)return stream.emit("end");stream.emit("data",data)}}function _end(){stream.writable=!1,end.call(stream),stream.readable||stream.destroy()}write=write||function(data){this.emit("data",data)},end=end||function(){this.emit("end")};var ended=!1,destroyed=!1,stream=new Stream,buffer=[];return stream.buffer=buffer,stream.readable=stream.writable=!0,stream.paused=!1,stream.write=function(data){return write.call(this,data),!stream.paused},stream.queue=function(data){buffer.push(data),drain()},stream.on("end",function(){stream.readable=!1,stream.writable||process.nextTick(function(){stream.destroy()})}),stream.end=function(data){ended||(ended=!0,arguments.length&&stream.write(data),_end())},stream.destroy=function(){destroyed||(destroyed=!0,ended=!0,buffer.length=0,stream.writable=stream.readable=!1,stream.emit("close"))},stream.pause=function(){stream.paused||(stream.paused=!0,stream.emit("pause"))},stream.resume=function(){stream.paused&&(stream.paused=!1),drain(),stream.paused||stream.emit("drain")},stream}var Stream=require("stream");exports=module.exports=through,through.through=through}).call(this,require("_process"))},{_process:8,stream:20}],64:[function(require,module){function tokenize(){function token(data){data.length&&stream.queue({type:map[mode],data:data,position:start,line:line})}function write(chunk){for(i=0,input+=chunk.toString(),len=input.length;c=input[i],len>i;)switch(mode){case BLOCK_COMMENT:i=block_comment();break;case LINE_COMMENT:i=line_comment();break;case PREPROCESSOR:i=preprocessor();break;case OPERATOR:i=operator();break;case INTEGER:i=integer();break;case HEX:i=hex();break;case FLOAT:i=decimal();break;case TOKEN:i=readtoken();break;case WHITESPACE:i=whitespace();break;case NORMAL:i=normal()}total+=i,input=input.slice(i)}function end(){content.length&&token(content.join("")),mode=EOF,token("(eof)"),stream.queue(null)}function normal(){return content=content.length?[]:content,"/"===last&&"*"===c?(start=total+i-1,mode=BLOCK_COMMENT,last=c,i+1):"/"===last&&"/"===c?(start=total+i-1,mode=LINE_COMMENT,last=c,i+1):"#"===c?(mode=PREPROCESSOR,start=total+i,i):/\s/.test(c)?(mode=WHITESPACE,start=total+i,i):(isnum=/\d/.test(c),isoperator=/[^\w_]/.test(c),start=total+i,mode=isnum?INTEGER:isoperator?OPERATOR:TOKEN,i)}function whitespace(){return"\n"===c&&++line,/[^\s]/g.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function preprocessor(){return"\n"===c&&++line,"\n"===c&&"\\"!==last?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function line_comment(){return preprocessor()}function block_comment(){return"/"===c&&"*"===last?(content.push(c),token(content.join("")),mode=NORMAL,i+1):("\n"===c&&++line,content.push(c),last=c,i+1)}function operator(){if("."===last&&/\d/.test(c))return mode=FLOAT,i;if("/"===last&&"*"===c)return mode=BLOCK_COMMENT,i;if("/"===last&&"/"===c)return mode=LINE_COMMENT,i;if("."===c&&content.length){for(;determine_operator(content););return mode=FLOAT,i}if(";"===c||")"===c||"("===c){if(content.length)for(;determine_operator(content););return token(c),mode=NORMAL,i+1}var is_composite_operator=2===content.length&&"="!==c;if(/[\w_\d\s]/.test(c)||is_composite_operator){for(;determine_operator(content););return mode=NORMAL,i}return content.push(c),last=c,i+1}function determine_operator(buf){for(var idx,j=0;;){idx=operators.indexOf(buf.slice(0,buf.length+j).join(""));{if(-1!==idx)return token(operators[idx]),start+=operators[idx].length,content=content.slice(operators[idx].length),content.length;j-=1}}}function hex(){return/[^a-fA-F0-9]/.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function integer(){return"."===c?(content.push(c),mode=FLOAT,last=c,i+1):/[eE]/.test(c)?(content.push(c),mode=FLOAT,last=c,i+1):"x"===c&&1===content.length&&"0"===content[0]?(mode=HEX,content.push(c),last=c,i+1):/[^\d]/.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function decimal(){return"f"===c&&(content.push(c),last=c,i+=1),/[eE]/.test(c)?(content.push(c),last=c,i+1):/[^\d]/.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function readtoken(){if(/[^\d\w_]/.test(c)){var contentstr=content.join("");return mode=literals.indexOf(contentstr)>-1?KEYWORD:builtins.indexOf(contentstr)>-1?BUILTIN:IDENT,token(content.join("")),mode=NORMAL,i}return content.push(c),last=c,i+1}var c,last,len,stream=through(write,end),i=0,total=0,mode=NORMAL,content=[],line=1,start=0,isnum=!1,isoperator=!1,input="";return stream}module.exports=tokenize;var through=require("through"),literals=require("./lib/literals"),operators=require("./lib/operators"),builtins=require("./lib/builtins"),NORMAL=999,TOKEN=9999,BLOCK_COMMENT=0,LINE_COMMENT=1,PREPROCESSOR=2,OPERATOR=3,INTEGER=4,FLOAT=5,IDENT=6,BUILTIN=7,KEYWORD=8,WHITESPACE=9,EOF=10,HEX=11,map=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":65,"./lib/literals":66,"./lib/operators":67,through:68}],65:[function(require,module){module.exports=["gl_Position","gl_PointSize","gl_ClipVertex","gl_FragCoord","gl_FrontFacing","gl_FragColor","gl_FragData","gl_FragDepth","gl_Color","gl_SecondaryColor","gl_Normal","gl_Vertex","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_FogCoord","gl_MaxLights","gl_MaxClipPlanes","gl_MaxTextureUnits","gl_MaxTextureCoords","gl_MaxVertexAttribs","gl_MaxVertexUniformComponents","gl_MaxVaryingFloats","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformComponents","gl_MaxDrawBuffers","gl_ModelViewMatrix","gl_ProjectionMatrix","gl_ModelViewProjectionMatrix","gl_TextureMatrix","gl_NormalMatrix","gl_ModelViewMatrixInverse","gl_ProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverse","gl_TextureMatrixInverse","gl_ModelViewMatrixTranspose","gl_ProjectionMatrixTranspose","gl_ModelViewProjectionMatrixTranspose","gl_TextureMatrixTranspose","gl_ModelViewMatrixInverseTranspose","gl_ProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixInverseTranspose","gl_TextureMatrixInverseTranspose","gl_NormalScale","gl_DepthRangeParameters","gl_DepthRange","gl_ClipPlane","gl_PointParameters","gl_Point","gl_MaterialParameters","gl_FrontMaterial","gl_BackMaterial","gl_LightSourceParameters","gl_LightSource","gl_LightModelParameters","gl_LightModel","gl_LightModelProducts","gl_FrontLightModelProduct","gl_BackLightModelProduct","gl_LightProducts","gl_FrontLightProduct","gl_BackLightProduct","gl_FogParameters","gl_Fog","gl_TextureEnvColor","gl_EyePlaneS","gl_EyePlaneT","gl_EyePlaneR","gl_EyePlaneQ","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_ObjectPlaneR","gl_ObjectPlaneQ","gl_FrontColor","gl_BackColor","gl_FrontSecondaryColor","gl_BackSecondaryColor","gl_TexCoord","gl_FogFragCoord","gl_Color","gl_SecondaryColor","gl_TexCoord","gl_FogFragCoord","gl_PointCoord","radians","degrees","sin","cos","tan","asin","acos","atan","pow","exp","log","exp2","log2","sqrt","inversesqrt","abs","sign","floor","ceil","fract","mod","min","max","clamp","mix","step","smoothstep","length","distance","dot","cross","normalize","faceforward","reflect","refract","matrixCompMult","lessThan","lessThanEqual","greaterThan","greaterThanEqual","equal","notEqual","any","all","not","texture2D","texture2DProj","texture2DLod","texture2DProjLod","textureCube","textureCubeLod"]},{}],66:[function(require,module){module.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],67:[function(require,module){module.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],68:[function(require,module,exports){(function(process){function through(write,end,opts){function drain(){for(;buffer.length&&!stream.paused;){var data=buffer.shift();if(null===data)return stream.emit("end");stream.emit("data",data)}}function _end(){stream.writable=!1,end.call(stream),!stream.readable&&stream.autoDestroy&&stream.destroy()}write=write||function(data){this.queue(data)},end=end||function(){this.queue(null)};var ended=!1,destroyed=!1,buffer=[],_ended=!1,stream=new Stream;return stream.readable=stream.writable=!0,stream.paused=!1,stream.autoDestroy=!(opts&&opts.autoDestroy===!1),stream.write=function(data){return write.call(this,data),!stream.paused},stream.queue=stream.push=function(data){return _ended?stream:(null==data&&(_ended=!0),buffer.push(data),drain(),stream)},stream.on("end",function(){stream.readable=!1,!stream.writable&&stream.autoDestroy&&process.nextTick(function(){stream.destroy()})}),stream.end=function(data){return ended?void 0:(ended=!0,arguments.length&&stream.write(data),_end(),stream)},stream.destroy=function(){return destroyed?void 0:(destroyed=!0,ended=!0,buffer.length=0,stream.writable=stream.readable=!1,stream.emit("close"),stream)},stream.pause=function(){return stream.paused?void 0:(stream.paused=!0,stream)},stream.resume=function(){return stream.paused&&(stream.paused=!1,stream.emit("resume")),drain(),stream.paused||stream.emit("drain"),stream},stream}var Stream=require("stream");exports=module.exports=through,through.through=through}).call(this,require("_process"))},{_process:8,stream:20}],69:[function(require,module){function getWebGLContext(canvas,options){if(canvas.getContext)for(var i=0;i<CONTEXTS.length;++i)try{var ctx=canvas.getContext(CONTEXTS[i],options||{});
if(ctx)return ctx}catch(e){}}function extend(obj){for(var a=1;a<arguments.length;++a){var source=arguments[a];for(var prop in source)void 0!==source[prop]&&(obj[prop]=source[prop])}return obj}function GlslTransitionCore(canvas,opts){function init(){transitions=[],gl=getWebGLContext(canvas,contextAttributes),canvas.addEventListener("webglcontextlost",onContextLost,!1),canvas.addEventListener("webglcontextrestored",onContextRestored,!1)}function onContextLost(e){e.preventDefault(),gl=null;for(var i=0;i<transitions.length;++i)transitions[i].onContextLost(e)}function onContextRestored(e){gl=getWebGLContext(canvas,contextAttributes);var i;for(i=0;i<userContextLostWatchers.length;++i)userContextLostWatchers[i](e);for(i=0;i<transitions.length;++i)transitions[i].onContextRestored(e)}function createTexture(){var texture=gl.createTexture();return gl.bindTexture(gl.TEXTURE_2D,texture),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),texture}function syncTexture(texture,image){gl.bindTexture(gl.TEXTURE_2D,texture),image?(gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!0),"function"==typeof image?image(gl):gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,image)):gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,2,2,0,gl.RGBA,gl.UNSIGNED_BYTE,null)}function loadTransitionShader(glsl,glslTypes){var name,uniformsByName=extend({},glslTypes.uniforms,VERTEX_TYPES.uniforms),attributesByName=extend({},glslTypes.attributes,VERTEX_TYPES.attributes),uniforms=[],attributes=[];for(name in uniformsByName)uniforms.push({name:name,type:uniformsByName[name]});for(name in attributesByName)attributes.push({name:name,type:attributesByName[name]});var shader=createShader(gl,VERTEX_SHADER,glsl,uniforms,attributes);return gl.bindBuffer(gl.ARRAY_BUFFER,gl.createBuffer()),shader.attributes.position.pointer(),shader}function draw(){gl.drawArrays(gl.TRIANGLES,0,6)}function createTransition(glsl){function load(){if(gl){shader=loadTransitionShader(glsl,glslTypes),textureUnits={},textures={};var i=0;for(var name in glslTypes.uniforms){var t=glslTypes.uniforms[name];"sampler2D"===t&&(gl.activeTexture(gl.TEXTURE0+i),textureUnits[name]=i,textures[name]=createTexture(),i++)}}}function onContextLost(){shader=null}function onContextRestored(){load()}function syncViewport(){var w=canvas.width,h=canvas.height;gl.viewport(0,0,w,h),currentShader&&(currentShader.uniforms[RESOLUTION_UNIFORM]=new Float32Array([w,h]));var x1=0,x2=w,y1=0,y2=h;gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([x1,y1,x2,y1,x1,y2,x1,y2,x2,y1,x2,y2]),gl.STATIC_DRAW)}function setProgress(p){shader.uniforms[PROGRESS_UNIFORM]=p}function setUniform(name,value){if(name in textureUnits){var i=textureUnits[name],texture=textures[name];gl.activeTexture(gl.TEXTURE0+i),gl.bindTexture(gl.TEXTURE_2D,texture),syncTexture(texture,value),shader.uniforms[name]=i}else shader.uniforms[name]=value}function reset(){var hasChanged=!1;return shader||(load(),hasChanged=!0),currentShader!==shader&&(currentShader=shader,shader.bind(),hasChanged=!0),syncViewport(),hasChanged}function destroy(){currentShader===shader&&(currentShader=null),shader&&(shader.dispose(),shader=null)}function getUniforms(){return extend({},glslTypes.uniforms)}var shader,textureUnits,textures,glslTypes=glslExports(glsl),transition={getGL:function(){return gl},load:function(){shader||load()},bind:function(){currentShader!==shader&&(currentShader=shader,shader.bind())},isCurrentTransition:function(){return currentShader===shader},onContextLost:onContextLost,onContextRestored:onContextRestored,syncViewport:syncViewport,setProgress:setProgress,setUniform:setUniform,reset:reset,draw:draw,destroy:destroy,getUniforms:getUniforms};return transitions.push(transition),transition}if(1!==arguments.length||!("getContext"in canvas))throw new Error("Bad arguments. usage: GlslTransitionCore(canvas)");var gl,currentShader,transitions,contextAttributes=extend({},opts&&opts.contextAttributes||{},GlslTransitionCore.defaults.contextAttributes),userContextLostWatchers=[];return createTransition.onContextLost=function(f){userContextLostWatchers.push(f)},createTransition.getGL=function(){return gl},init(),createTransition}var createShader=require("gl-shader-core"),glslExports=require("glsl-exports"),VERTEX_SHADER="attribute vec2 position; void main() { gl_Position = vec4(2.0*position-1.0, 0.0, 1.0);}",VERTEX_TYPES=glslExports(VERTEX_SHADER),PROGRESS_UNIFORM="progress",RESOLUTION_UNIFORM="resolution",CONTEXTS=["webgl","experimental-webgl"];GlslTransitionCore.defaults={contextAttributes:{preserveDrawingBuffer:!0}},GlslTransitionCore.isSupported=function(){var c=document.createElement("canvas");return!!getWebGLContext(c)},module.exports=GlslTransitionCore},{"gl-shader-core":57,"glsl-exports":58}],70:[function(require,module){module.exports=require(30)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-core/node_modules/raf/node_modules/performance-now/lib/performance-now.js":30,_process:8}],71:[function(require,module){module.exports=require(47)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/q/q.js":47,_process:8}],72:[function(require,module){for(var now=require("performance-now"),global="undefined"==typeof window?{}:window,vendors=["moz","webkit"],suffix="AnimationFrame",raf=global["request"+suffix],caf=global["cancel"+suffix]||global["cancelRequest"+suffix],i=0;i<vendors.length&&!raf;i++)raf=global[vendors[i]+"Request"+suffix],caf=global[vendors[i]+"Cancel"+suffix]||global[vendors[i]+"CancelRequest"+suffix];if(!raf||!caf){var last=0,id=0,queue=[],frameDuration=1e3/60;raf=function(callback){if(0===queue.length){var _now=now(),next=Math.max(0,frameDuration-(_now-last));last=next+_now,setTimeout(function(){var cp=queue.slice(0);queue.length=0;for(var i=0;i<cp.length;i++)cp[i].cancelled||cp[i].callback(last)},next)}return queue.push({handle:++id,callback:callback,cancelled:!1}),id},caf=function(handle){for(var i=0;i<queue.length;i++)queue[i].handle===handle&&(queue[i].cancelled=!0)}}module.exports=function(){return raf.apply(global,arguments)},module.exports.cancel=function(){caf.apply(global,arguments)}},{"performance-now":70}],73:[function(require,module){function extend(obj){for(var a=1;a<arguments.length;++a){var source=arguments[a];for(var prop in source)void 0!==source[prop]&&(obj[prop]=source[prop])}return obj}function identity(x){return x}function TransitionAbortedError(message){this.message=message,this.stack=(new Error).stack}function GlslTransition(canvas){function onContextLost(){currentAnimationD&&(currentAnimationD.reject(new TransitionAbortedError("WebGL Context Lost")),currentAnimationD=null)}function createTransition(glsl,defaultUniforms){function animate(transitionDuration,transitionEasing,allUniforms){var transitionStart=now(),frames=0,fromWillNeedRefresh=!(allUniforms.from instanceof window.HTMLImageElement),toWillNeedRefresh=!(allUniforms.to instanceof window.HTMLImageElement),d=Q.defer();return currentAnimationD=d,function render(){if(currentAnimationD===d){++frames;var t=now(),p=(t-transitionStart)/transitionDuration;try{1>p?(requestAnimationFrame(render,canvas),fromWillNeedRefresh&&transitionCore.setUniform("from",allUniforms.from),toWillNeedRefresh&&transitionCore.setUniform("to",allUniforms.to),transitionCore.setProgress(transitionEasing(p)),transitionCore.draw()):(fromWillNeedRefresh&&transitionCore.setUniform("from",allUniforms.from),toWillNeedRefresh&&transitionCore.setUniform("to",allUniforms.to),transitionCore.setProgress(transitionEasing(1)),transitionCore.draw(),d.resolve({startAt:transitionStart,endAt:t,elapsedTime:t-transitionStart,frames:frames}),currentAnimationD=null)}catch(e){d.reject(e),currentAnimationD=null}}}(),d.promise}function transition(uniforms,duration,easing){if(easing||(easing=identity),arguments.length<2||arguments.length>3||"object"!=typeof uniforms||"number"!=typeof duration||0>=duration||"function"!=typeof easing)throw new Error("Bad arguments. usage: t(uniforms, duration, easing) -- uniforms is an Object, duration an integer > 0, easing an optional function.");var allUniforms=extend({},defaultUniforms,uniforms);allUniforms[PROGRESS_UNIFORM]=easing(0);var name;for(name in glslUniforms)if(name!==RESOLUTION_UNIFORM&&!(name in allUniforms))throw new Error("uniform '"+name+"': You must provide an initial value.");for(name in uniforms){if(name===RESOLUTION_UNIFORM)throw new Error("The '"+name+"' uniform is reserved, you must not use it.");if(!(name in glslUniforms))throw new Error("uniform '"+name+"': This uniform does not exist in your GLSL code.")}if(!createTransitionCore.getGL())return Q.reject(new Error("WebGL context is null."));if(currentAnimationD)return Q.reject(new Error("another transition is already running."));try{transitionCore.load()}catch(e){return Q.reject(e)}transitionCore.bind();for(name in allUniforms)transitionCore.setUniform(name,allUniforms[name]);return transitionCore.syncViewport(),animate(duration,easing,allUniforms)}var transitionCore=createTransitionCore.apply(this,arguments),glslUniforms=transitionCore.getUniforms();if("object"!=typeof defaultUniforms&&(defaultUniforms={}),arguments.length<1||arguments.length>2||"string"!=typeof glsl)throw new Error("Bad arguments. usage: T(glsl [, options])");for(var name in defaultUniforms){if(name===RESOLUTION_UNIFORM)throw new Error("The '"+name+"' uniform is reserved, you must not use it.");if(!(name in glslUniforms))throw new Error("uniform '"+name+"': This uniform does not exist in your GLSL code.")}return currentAnimationD||transitionCore.load(),transition.destroy=function(){transitionCore.isCurrentTransition()&&currentAnimationD&&(currentAnimationD.reject(new TransitionAbortedError("Transition destroyed.")),currentAnimationD=null),transitionCore.destroy()},transition.core=transitionCore,transition}var currentAnimationD,createTransitionCore=GlslTransitionCore.apply(this,arguments);return createTransitionCore.onContextLost(onContextLost),createTransition.core=createTransitionCore,createTransition.abort=function(){currentAnimationD&&(currentAnimationD.reject(new TransitionAbortedError("Transition aborted by user.")),currentAnimationD=null)},createTransition}var GlslTransitionCore=require("glsl-transition-core"),Q=require("q"),requestAnimationFrame=require("raf"),now=require("performance-now"),PROGRESS_UNIFORM="progress",RESOLUTION_UNIFORM="resolution";TransitionAbortedError.prototype=new Error,TransitionAbortedError.prototype.name="TransitionAbortedError",GlslTransition.TransitionAbortedError=TransitionAbortedError,GlslTransition.defaults=GlslTransitionCore.defaults,GlslTransition.isSupported=GlslTransitionCore.isSupported,GlslTransition.GlslTransitionCore=GlslTransitionCore,GlslTransition.Q=Q,GlslTransition.requestAnimationFrame=requestAnimationFrame,GlslTransition.now=now,module.exports=GlslTransition},{"glsl-transition-core":69,"performance-now":70,q:71,raf:72}],74:[function(require,module){module.exports=require(28)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-core/node_modules/performance-now/lib/performance-now.js":28,_process:8}],75:[function(require,module){module.exports=require(29)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-core/node_modules/raf/index.js":29,"performance-now":76}],76:[function(require,module){module.exports=require(30)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-core/node_modules/raf/node_modules/performance-now/lib/performance-now.js":30,_process:8}],77:[function(require,module){module.exports=require(33)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-dom/node_modules/zanimo/node_modules/color/color.js":33,"color-convert":79,"color-string":80}],78:[function(require,module){module.exports=require(34)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-dom/node_modules/zanimo/node_modules/color/node_modules/color-convert/conversions.js":34}],79:[function(require,module){module.exports=require(35)},{"./conversions":78,"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-dom/node_modules/zanimo/node_modules/color/node_modules/color-convert/index.js":35}],80:[function(require,module){module.exports=require(36)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-dom/node_modules/zanimo/node_modules/color/node_modules/color-string/color-string.js":36,"color-convert":79}],81:[function(require,module){module.exports=require(47)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/q/q.js":47,_process:8}],82:[function(require,module){module.exports=require(37)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-dom/node_modules/zanimo/node_modules/qanimationframe/node_modules/q/q.js":37,_process:8}],83:[function(require,module){module.exports=require(38)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-dom/node_modules/zanimo/node_modules/qanimationframe/src/qanimationframe.js":38,q:82}],84:[function(require,module){module.exports=require(39)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-dom/node_modules/zanimo/node_modules/vendor-prefix/index.js":39}],85:[function(require,module){module.exports=require(40)},{"../src/normalize-transform-value":87,"../src/transition-shorthand-property":88,"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-dom/node_modules/zanimo/src/Zanimo.js":40,q:81,qanimationframe:83,"vendor-prefix":84}],86:[function(require,module){module.exports=require(41)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-dom/node_modules/zanimo/src/normalize-timing-function.js":41}],87:[function(require,module){module.exports=require(42)},{"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-dom/node_modules/zanimo/src/normalize-transform-value.js":42,color:77}],88:[function(require,module){module.exports=require(43)},{"./normalize-timing-function":86,"./normalize-transform-value":87,"/Volumes/Case Sensitive/perso/kenburns-example/node_modules/kenburns/node_modules/kenburns-dom/node_modules/zanimo/src/transition-shorthand-property.js":43,"vendor-prefix":84}]},{},[22]);